# Author(s): AngriestBird, DrCthulhuFace
add_namespace = spain

# Index of Events:
# spain.1 to spain.50 -- Cultural Events
# spain.50 to spain.200 -- Focus events
# spain.201 to spain.500 -- Flavor Events (Non-Focus Related: ETA, Catalonian Crisis, Migrant Crisis)
# spain.500 to 550 -- Election Events

## Cultural Events
# The Canaries Movement
country_event = {
	id = spain.1
	title = spain.1.t
	desc = spain.1.d
	trigger = {
		original_tag = SPR
	}
	picture = GFX_canary_islands_flag
	is_triggered_only = yes
	fire_only_once = yes

	# Stifle the Movement
	option = {
		name = spain.1.a
		log = "[GetDateText]: [This.GetName]: spain.1.a executed"

		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = -15 }
		SPR_modify_cultural_opinion = yes
		if = { limit = { NOT = { is_in_array = { ruling_party = 20 } } }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.04 }
			add_relative_party_popularity = yes
		}
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		hidden_effect = {
			set_country_flag = SPR_stifled_canarios_movement
		}
		ai_chance = {
			factor = 0
			modifier = {
				is_historical_focus_on = no
				add = 5
			}
		}
	}

	# Hold the Movement on a Leash
	option = {
		name = spain.1.b
		log = "[GetDateText]: [This.GetName]: spain.1.b executed"

		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		if = { limit = { NOT = { is_in_array = { ruling_party = 20 } } }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.02 }
			add_relative_party_popularity = yes
		}

		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		hidden_effect = {
			set_country_flag = SPR_limited_canarios_movement
		}
		ai_chance = {
			factor = 1
			modifier = {
				is_historical_focus_on = yes
				add = 5
			}
		}
	}

	# Unhinge the Canaries
	option = {
		name = spain.1.c
		log = "[GetDateText]: [This.GetName]: spain.1.c executed"
		custom_effect_tooltip = SPR_spain_1_c_tt

		if = { limit = { NOT = { is_in_array = { ruling_party = 20 } } }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = 0.02 }
			add_relative_party_popularity = yes
		}

		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes
		add_stability = 0.03
		hidden_effect = {
			set_country_flag = SPR_unhinged_canarios_movement
		}
		ai_chance = {
			factor = 0
			modifier = {
				is_historical_focus_on = no
				add = 5
			}
		}
	}
}

# The Bilbao Convention
country_event = {
	id = spain.2
	title = spain.2.t
	desc = spain.2.d
	picture = GFX_bilbao
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Keep the Status Quo
	option = {
		name = spain.2.a
		log = "[GetDateText]: [This.GetName]: spain.2.a executed"

		add_political_power = 50
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_bilbao_convention_status_quo
		ai_chance = {
			factor = 1
		}
	}

	# Limit Their Freedoms
	option = {
		name = spain.2.b
		log = "[GetDateText]: [This.GetName]: spain.2.b executed"

		add_political_power = -25
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_bilbao_convention_limit_freedoms
		ai_chance = {
			factor = 0.25
		}
	}


	# Crush all Resistance
	option = {
		name = spain.2.c
		log = "[GetDateText]: [This.GetName]: spain.2.b executed"

		add_political_power = -50
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_bilbao_convention_crush_basque
		ai_chance = {
			factor = 0.25
			modifier = {
				factor = 1.5
				has_elections = no
			}
			modifier = {
				factor = 2
				has_government = nationalist
			}
		}
	}
}

# The Lugo List
country_event = {
	id = spain.3
	title = spain.3.t
	desc = spain.3.d
	picture = GFX_lugo
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Keep the Status Quo
	option = {
		name = spain.3.a
		log = "[GetDateText]: [This.GetName]: spain.3.a executed"

		add_political_power = 50
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_lugo_convention_status_quo
		ai_chance = {
			factor = 1
		}
	}

	# Limit Their Freedoms
	option = {
		name = spain.3.b
		log = "[GetDateText]: [This.GetName]: spain.3.b executed"

		add_political_power = -25
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_lugo_convention_limit_freedoms
		ai_chance = {
			factor = 0.25
		}
	}


	# Crush all Resistance
	option = {
		name = spain.3.c
		log = "[GetDateText]: [This.GetName]: spain.3.b executed"

		add_political_power = -50
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_lugo_convention_crush_galegos
		ai_chance = {
			factor = 0.25
		}
	}
}

# Barcelonian Reconciliation
country_event = {
	id = spain.4
	title = spain.4.t
	desc = spain.4.d
	picture = GFX_barcelona_photo
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Keep the Status Quo
	option = {
		name = spain.4.a
		log = "[GetDateText]: [This.GetName]: spain.4.a executed"

		add_political_power = 50
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_barcelona_convention_status_quo
		ai_chance = {
			factor = 1
		}
	}

	# Limit Their Freedoms
	option = {
		name = spain.4.b
		log = "[GetDateText]: [This.GetName]: spain.4.b executed"

		add_political_power = -25
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_barcelona_convention_limit_freedoms
		ai_chance = {
			factor = 0.25

		}
	}


	# Crush all Resistance
	option = {
		name = spain.4.c
		log = "[GetDateText]: [This.GetName]: spain.4.b executed"

		add_political_power = -50
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_barcelona_crush_the_catalans
		ai_chance = {
			factor = 0.25
		}
	}
}

# Seville Pact
country_event = {
	id = spain.5
	title = spain.5.t
	desc = spain.5.d
	picture = GFX_sevilla
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Keep the Status Quo
	option = {
		name = spain.5.a
		log = "[GetDateText]: [This.GetName]: spain.5.a executed"

		add_political_power = 50
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_seville_convention_status_quo
		ai_chance = {
			factor = 1
		}
	}

	# Limit Their Freedoms
	option = {
		name = spain.5.b
		log = "[GetDateText]: [This.GetName]: spain.5.b executed"

		add_political_power = -25
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_seville_convention_limit_freedoms
		ai_chance = {
			factor = 0.25
		}
	}


	# Crush all Resistance
	option = {
		name = spain.5.c
		log = "[GetDateText]: [This.GetName]: spain.5.b executed"

		add_political_power = -50
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_seville_crush_the_andalucia
		ai_chance = {
			factor = 0.25
		}
	}
}

# The Northern Citizenship Question
country_event = {
	id = spain.6
	title = spain.6.t
	desc = spain.6.d
	picture = GFX_political_deal
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Revoke Citizenship
	option = {
		name = spain.6.a
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 1 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.07 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		custom_effect_tooltip = SPR_revoking_citizenship_northerner_tt
		unlock_decision_tooltip = SPR_revoke_galician_citizenship_decision
		unlock_decision_tooltip = SPR_revoke_basque_citizenship_decision
		set_country_flag = SPR_revoke_citizenship_northerner_flag
	}

	# Softer Approach
	option = {
		name = spain.6.b
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 1 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.07 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		add_stability = 0.02
		add_political_power = 75
		set_country_flag = SPR_a_soft_approach_northerner_flag
	}

	# Reconciliation aka on second thought
	option = {
		name = spain.6.c
		add_political_power = 150
		add_stability = 0.04
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = -0.04 }
		set_temp_variable = { temp_outlook_increase = -0.07 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_reconciliation_northerner_flag
	}
}

# The Southern Citizenship Question
country_event = {
	id = spain.7
	title = spain.7.t
	desc = spain.7.d
	picture = GFX_political_deal
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Revoke Citizenship
	option = {
		name = spain.7.a
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 1 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.07 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		custom_effect_tooltip = SPR_revoking_citizenship_southerner_tt
		unlock_decision_tooltip = SPR_revoke_catalonian_citizenship_decision
		unlock_decision_tooltip = SPR_revoke_andalucian_citizenship_decision
		set_country_flag = SPR_revoke_citizenship_southerner_flag
	}
	# Softer Approach
	option = {
		name = spain.7.b
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 1 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.07 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		add_stability = 0.02
		add_political_power = 75
		set_country_flag = SPR_a_soft_approach_southerner_flag
	}
	# Reconciliation
	option = {
		name = spain.7.c
		add_political_power = 150
		add_stability = 0.04
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = -0.04 }
		set_temp_variable = { temp_outlook_increase = -0.07 }
		add_relative_party_popularity = yes

		set_country_flag = SPR_reconciliation_southerner_flag
	}
}

# Random Event Trigger
# Compendium
# 3 Random events

# Basque Support Us
country_event = {
	id = spain.8
	title = spain.8.t
	desc = spain.8.d
	picture = GFX_politics_negotiations
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.8.a
		log = "[GetDateText]: [This.GetName]: spain.8.a executed"

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.8.b
		log = "[GetDateText]: [This.GetName]: spain.8.b executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = 0.003 }
		multiply_temp_variable = { treasury_change = -1 }
		modify_treasury_effect = yes

		add_political_power = -25

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}
}

# Basque Protests
country_event = {
	id = spain.9
	title = spain.9.t
	desc = spain.9.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.9.a
		log = "[GetDateText]: [This.GetName]: spain.9.a executed"

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.01 }
		add_relative_party_popularity = yes
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.9.b
		log = "[GetDateText]: [This.GetName]: spain.9.b executed"

		random_list = {
			25 = {
				# riot
				country_event = { id = spain.10 days = 7 random_days = 7 }
			}
			75 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.9.c
		log = "[GetDateText]: [This.GetName]: spain.9.c executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.10 days = 7 random_days = 7}
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.15 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.45 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.6 }
			modify_treasury_effect = yes

		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.75 }
			modify_treasury_effect = yes
		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.035 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}
}

# Basque Riots
country_event = {
	id = spain.10
	title = spain.10.t
	desc = spain.10.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.10.a
		log = "[GetDateText]: [This.GetName]: spain.10.a executed"

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		88 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.10.b
		log = "[GetDateText]: [This.GetName]: spain.10.b executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.11 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -5 }
			SPR_modify_cultural_opinion = yes

			88 = {
				damage_building = {
					type = infrastructure
					damage = 0.8
				}
				damage_building = {
					type = offices
					damage = 0.8
				}
				damage_building = {
					type = industrial_complex
					damage = 0.8
				}
			}
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes

			88 = {
				damage_building = {
					type = infrastructure
					damage = 0.6
				}
				damage_building = {
					type = offices
					damage = 0.6
				}
				damage_building = {
					type = industrial_complex
					damage = 0.6
				}
			}
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes

			88 = {
				damage_building = {
					type = infrastructure
					damage = 0.4
				}
				damage_building = {
					type = offices
					damage = 0.4
				}
				damage_building = {
					type = industrial_complex
					damage = 0.4
				}
			}
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes

			88 = {
				damage_building = {
					type = infrastructure
					damage = 0.2
				}
				damage_building = {
					type = offices
					damage = 0.2
				}
				damage_building = {
					type = industrial_complex
					damage = 0.2
				}
			}
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Clashes With Police In Basque
country_event = {
	id = spain.11
	title = spain.11.t
	desc = spain.11.d
	picture = GFX_guardia_civil
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.11.a

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		add_manpower = -20

		88 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}
	}
}

# Galegos
# Galegos Support Us
country_event = {
	id = spain.12
	title = spain.12.t
	desc = spain.12.d
	picture = GFX_politics_negotiations
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.12.a
		log = "[GetDateText]: [This.GetName]: spain.12.a executed"

		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.12.b
		log = "[GetDateText]: [This.GetName]: spain.12.b executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = 0.003 }
		multiply_temp_variable = { treasury_change = -1 }
		modify_treasury_effect = yes
		add_political_power = -25

		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}
}

# Galegos Protests
country_event = {
	id = spain.13
	title = spain.13.t
	desc = spain.13.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.13.a
		log = "[GetDateText]: [This.GetName]: spain.13.a executed"
		#large effect, no cost, no/low chance of escalation
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.01 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.13.b
		log = "[GetDateText]: [This.GetName]: spain.13.b executed"

		random_list = {
			25 = {
				# riot
				country_event = { id = spain.14 days = 7 random_days = 7 }
			}
			75 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes


		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.13.c
		log = "[GetDateText]: [This.GetName]: spain.13.c executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.14 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}
			if = { limit = { has_idea = police_01}
				set_temp_variable = { treasury_change = -0.15 }
				modify_treasury_effect = yes

				set_temp_variable = { culture_index = 2 }
				set_temp_variable = { cultural_opinion = -3 }
				SPR_modify_cultural_opinion = yes
			}
			if = { limit = { has_idea = police_02}
				set_temp_variable = { treasury_change = -0.3 }
				modify_treasury_effect = yes

				set_temp_variable = { culture_index = 2 }
				set_temp_variable = { cultural_opinion = -2 }
				SPR_modify_cultural_opinion = yes
			}
			if = { limit = { has_idea = police_03}
				set_temp_variable = { treasury_change = -0.45 }
				modify_treasury_effect = yes

				set_temp_variable = { culture_index = 2 }
				set_temp_variable = { cultural_opinion = -1 }
				SPR_modify_cultural_opinion = yes
			}
			if = { limit = { has_idea = police_04}
				set_temp_variable = { treasury_change = -0.6 }
				modify_treasury_effect = yes

			}
			if = { limit = { has_idea = police_05}
				set_temp_variable = { treasury_change = -0.75 }
				modify_treasury_effect = yes
			}

			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.035 }
			add_relative_party_popularity = yes

			ai_chance = {
				factor = 1
			}
	}
}

# Galegos Riots
country_event = {
	id = spain.14
	title = spain.14.t
	desc = spain.14.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.14.a
		log = "[GetDateText]: [This.GetName]: spain.14.a executed"

		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		944 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.14.b
		log = "[GetDateText]: [This.GetName]: spain.14.b executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.15 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -5 }
			SPR_modify_cultural_opinion = yes

			944 = {
				damage_building = {
					type = infrastructure
					damage = 0.8
				}
				damage_building = {
					type = offices
					damage = 0.8
				}
				damage_building = {
					type = industrial_complex
					damage = 0.8
				}
			}
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes

			944 = {
				damage_building = {
					type = infrastructure
					damage = 0.6
				}
				damage_building = {
					type = offices
					damage = 0.6
				}
				damage_building = {
					type = industrial_complex
					damage = 0.6
				}
			}
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes

			944 = {
				damage_building = {
					type = infrastructure
					damage = 0.4
				}
				damage_building = {
					type = offices
					damage = 0.4
				}
				damage_building = {
					type = industrial_complex
					damage = 0.4
				}
			}
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes

			944 = {
				damage_building = {
					type = infrastructure
					damage = 0.2
				}
				damage_building = {
					type = offices
					damage = 0.2
				}
				damage_building = {
					type = industrial_complex
					damage = 0.2
				}
			}
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 2 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		ai_chance = {
			factor = 1
		}
	}
}

# clashes with police in Galicia
country_event = {
	id = spain.15
	title = spain.15.t
	desc = spain.15.d
	picture = GFX_guardia_civil
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.15.a
		log = "[GetDateText]: [This.GetName]: spain.15.a executed"

		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		add_manpower = -20

		944 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}
	}
}

# Catalonia
# The Catalonians Support Us
country_event = {
	id = spain.16
	title = spain.16.t
	desc = spain.16.d
	picture = GFX_politics_negotiations
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.16.a
		log = "[GetDateText]: [This.GetName]: spain.16.a executed"

		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.16.b
		log = "[GetDateText]: [This.GetName]: spain.16.b executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = 0.003 }
		multiply_temp_variable = { treasury_change = -1 }
		modify_treasury_effect = yes
		add_political_power = -25

		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}
}

# Catalan Protests
country_event = {
	id = spain.17
	title = spain.17.t
	desc = spain.17.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.17.a
		log = "[GetDateText]: [This.GetName]: spain.17.a executed"
		#large effect, no cost, no/low chance of escalation
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes


		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.01 }
		add_relative_party_popularity = yes


		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.17.b
		log = "[GetDateText]: [This.GetName]: spain.17.b executed"
		random_list = {
			25 = {
				# riot
				country_event = { id = spain.18 days = 7 random_days = 7 }
			}
			75 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}


		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.17.c
		log = "[GetDateText]: [This.GetName]: spain.17.c executed"
		random_list = {
			50 = {
				# riot
				country_event = { id = spain.18 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}


		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.15 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.45 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.6 }
			modify_treasury_effect = yes

		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.75 }
			modify_treasury_effect = yes
		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.035 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}
}

# Catalan Riots
country_event = {
	id = spain.18
	title = spain.18.t
	desc = spain.18.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.18.a
		log = "[GetDateText]: [This.GetName]: spain.18.a executed"

		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		86 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.18.b
		log = "[GetDateText]: [This.GetName]: spain.18.b executed"
		random_list = {
			50 = {
				# riot
				country_event = { id = spain.19 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}


		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -5 }
			SPR_modify_cultural_opinion = yes

			86 = {
				damage_building = {
					type = infrastructure
					damage = 0.8
				}
				damage_building = {
					type = offices
					damage = 0.8
				}
				damage_building = {
					type = industrial_complex
					damage = 0.8
				}
			}
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes

			86 = {
				damage_building = {
					type = infrastructure
					damage = 0.6
				}
				damage_building = {
					type = offices
					damage = 0.6
				}
				damage_building = {
					type = industrial_complex
					damage = 0.6
				}
			}
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes

			86 = {
				damage_building = {
					type = infrastructure
					damage = 0.4
				}
				damage_building = {
					type = offices
					damage = 0.4
				}
				damage_building = {
					type = industrial_complex
					damage = 0.4
				}
			}
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes

			86 = {
				damage_building = {
					type = infrastructure
					damage = 0.2
				}
				damage_building = {
					type = offices
					damage = 0.2
				}
				damage_building = {
					type = industrial_complex
					damage = 0.2
				}
			}
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 0 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}

		ai_chance = {
			factor = 1
		}
	}
}

# clashes with police in catalonia
country_event = {
	id = spain.19
	title = spain.19.t
	desc = spain.19.d
	picture = GFX_guardia_civil
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.19.a

		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		add_manpower = -20

		86 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}
	}
}

#Andalucia
# Andalucians Support Us
country_event = {
	id = spain.20
	title = spain.20.t
	desc = spain.20.d
	picture = GFX_politics_negotiations
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.20.a
		log = "[GetDateText]: [This.GetName]: spain.20.a executed"

		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.20.b
		log = "[GetDateText]: [This.GetName]: spain.20.b executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = 0.003 }
		multiply_temp_variable = { treasury_change = -1 }
		modify_treasury_effect = yes
		add_political_power = -25

		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}
}

# andalucian Protests
country_event = {
	id = spain.21
	title = spain.21.t
	desc = spain.21.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.21.a
		log = "[GetDateText]: [This.GetName]: spain.21.a executed"
		#large effect, no cost, no/low chance of escalation
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.01 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.21.b
		log = "[GetDateText]: [This.GetName]: spain.21.b executed"

		random_list = {
			25 = {
				# riot
				country_event = { id = spain.22 days = 7 random_days = 7 }
			}
			75 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}


		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.21.c
		log = "[GetDateText]: [This.GetName]: spain.21.c executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.22 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}


		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.15 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.45 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.6 }
			modify_treasury_effect = yes

		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.75 }
			modify_treasury_effect = yes
		}

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.035 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 1
		}
	}
}

# andalucian Riots
country_event = {
	id = spain.22
	title = spain.22.t
	desc = spain.22.d
	picture = GFX_politics_protest
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.22.a
		log = "[GetDateText]: [This.GetName]: spain.22.a executed"

		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		93 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.22.b
		log = "[GetDateText]: [This.GetName]: spain.22.b executed"

		random_list = {
			50 = {
				# riot
				country_event = { id = spain.23 days = 7 random_days = 7 }
			}
			50 = {
				# no riot
				modifier = {
					factor = 5.0
					has_idea = police_05
				}
				modifier = {
					factor = 4.0
					has_idea = police_04
				}
				modifier = {
					factor = 3.0
					has_idea = police_03
				}
				modifier = {
					factor = 2.0
					has_idea = police_02
				}
				modifier = {
					factor = 1.0
					has_idea = police_01
				}
			}
		}

		if = { limit = { has_idea = police_01}
			set_temp_variable = { treasury_change = -0.1 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -5 }
			SPR_modify_cultural_opinion = yes

			93 = {
				damage_building = {
					type = infrastructure
					damage = 0.8
				}
				damage_building = {
					type = offices
					damage = 0.8
				}
				damage_building = {
					type = industrial_complex
					damage = 0.8
				}
			}
		}
		if = { limit = { has_idea = police_02}
			set_temp_variable = { treasury_change = -0.2 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -4 }
			SPR_modify_cultural_opinion = yes

			93 = {
				damage_building = {
					type = infrastructure
					damage = 0.6
				}
				damage_building = {
					type = offices
					damage = 0.6
				}
				damage_building = {
					type = industrial_complex
					damage = 0.6
				}
			}
		}
		if = { limit = { has_idea = police_03}
			set_temp_variable = { treasury_change = -0.3 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -3 }
			SPR_modify_cultural_opinion = yes

			93 = {
				damage_building = {
					type = infrastructure
					damage = 0.4
				}
				damage_building = {
					type = offices
					damage = 0.4
				}
				damage_building = {
					type = industrial_complex
					damage = 0.4
				}
			}
		}
		if = { limit = { has_idea = police_04}
			set_temp_variable = { treasury_change = -0.4 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -2 }
			SPR_modify_cultural_opinion = yes

			93 = {
				damage_building = {
					type = infrastructure
					damage = 0.2
				}
				damage_building = {
					type = offices
					damage = 0.2
				}
				damage_building = {
					type = industrial_complex
					damage = 0.2
				}
			}
		}
		if = { limit = { has_idea = police_05}
			set_temp_variable = { treasury_change = -0.5 }
			modify_treasury_effect = yes

			set_temp_variable = { culture_index = 3 }
			set_temp_variable = { cultural_opinion = -1 }
			SPR_modify_cultural_opinion = yes
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Clashes with police in andalucia
country_event = {
	id = spain.23
	title = spain.23.t
	desc = spain.23.d
	picture = GFX_guardia_civil
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.23.a
		log = "[GetDateText]: [This.GetName]: spain.23.a executed"

		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		add_manpower = -20

		93 = {
			damage_building = {
				type = infrastructure
				damage = 1.0
			}
			damage_building = {
				type = offices
				damage = 1.0
			}
			damage_building = {
				type = industrial_complex
				damage = 1.0
			}
		}
	}
}

# The Question of Bullfighting
country_event = {
	id = spain.50
	title = spain.50.t
	desc = spain.50.d
	picture = GFX_toreador
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Ban bullfighting
	option = {
		name = spain.50.a
		log = "[GetDateText]: [This.GetName]: spain.50.a executed"

		add_political_power = -50
		add_stability = 0.03
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 4 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes

		hidden_effect = {
			# Banning Early prevents the Catalonian & Mallorca Event Chain
			set_country_flag = SPR_banned_bullfighting_flag
			country_event = { id = spain.51 days = 45 random_days = 45 }
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				is_historical_focus_on = no
				factor = 1.5
			}
		}
	}

	# Ban Killing the Bull
	option = {
		name = spain.50.b
		log = "[GetDateText]: [This.GetName]: spain.50.b executed"

		add_political_power = -25
		add_stability = 0.01
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 1 }
		SPR_modify_cultural_opinion = yes

		hidden_effect = {
			# Catalonia event chain will trigger but Mallorca event chain will not
			set_country_flag = SPR_banned_killing_the_bull_flag
			country_event = { id = spain.52 days = 45 random_days = 45 }
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				is_historical_focus_on = no
				factor = 3
			}
		}
	}

	# Allow the Practice to Continue
	option = {
		name = spain.50.c
		log = "[GetDateText]: [This.GetName]: spain.50.c executed"
		add_political_power = 100
		add_stability = -0.03
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		custom_effect_tooltip = SPR_allow_bullfighting_tt

		hidden_effect = {
			# Both Catalonia and Mallorca will have their event channels
			set_country_flag = SPR_allowed_the_practice_to_continue_flag
		}
		ai_chance = {
			factor = 1
			modifier = {
				is_historical_focus_on = yes
				factor = 1.25
			}
		}
	}
}

# The Spanish Constitutional Court Determines Ban Illegal
country_event = {
	id = spain.51
	title = spain.51.t
	desc = spain.51.d
	picture = GFX_const_court_spain
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Repeal the Ban
	# Reverts to pre-ban state.
	option = {
		name = spain.51.a
		log = "[GetDateText]: [This.GetName]: spain.51.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		hidden_effect = {
			clr_country_flag = SPR_banned_bullfighting_flag
		}
		ai_chance = {
			factor = 0
		}
	}

	# Challenge the Court
	# Triggers a mission in culture section that requires you to invest into a legal fund
	option = {
		name = spain.51.b
		log = "[GetDateText]: [This.GetName]: spain.51.b executed"

		activate_mission = SPR_challenge_the_court_ban_bull_mission
		ai_chance = {
			factor = 1
		}
	}

}

# Spanish Constitutional Court Determines Killing the Bull Partially Unconstitutional
country_event = {
	id = spain.52
	title = spain.52.t
	desc = spain.52.d
	picture = GFX_const_court_spain
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Repeal the Killing of the Bull
	option = {
		name = spain.52.a
		log = "[GetDateText]: [This.GetName]: spain.52.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		hidden_effect = {
			clr_country_flag = SPR_banned_killing_the_bull_flag
		}
		ai_chance = {
			factor = 0
		}
	}

	# Challenge the Court
	option = {
		name = spain.52.b
		log = "[GetDateText]: [This.GetName]: spain.52.b executed"

		activate_mission = SPR_challenge_the_court_killing_bull_mission
		ai_chance = {
			factor = 1
		}
	}
}

# Court Case Results
country_event = {
	id = spain.53
	title = spain.53.t
	desc = {
		text = spain.53.d1
		trigger = {
			OR = {
				has_country_flag = SPR_banfighting_is_upheld
				has_country_flag = SPR_bankilling_is_upheld
			}
		}
	}
	desc = {
		text = spain.53.d2
		trigger = {
			OR = {
				has_country_flag = SPR_banfighting_is_unconstitutional
				has_country_flag = SPR_bankilling_is_unconstitutional
			}
		}
	}
	picture = GFX_const_court_spain
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# The Ban is Upheld
	option = {
		name = spain.52.a
		trigger = {
			OR = {
				has_country_flag = SPR_banfighting_is_upheld
				has_country_flag = SPR_bankilling_is_upheld
			}
		}
		log = "[GetDateText]: [This.GetName]: spain.52.a executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.015 }
		add_relative_party_popularity = yes
		add_political_power = 50

		hidden_effect = {
			clr_country_flag = SPR_banfighting_is_upheld
			clr_country_flag = SPR_bankilling_is_upheld
		}
	}

	# The Ban is Denied and Repealed
	option = {
		name = spain.52.b
		trigger = {
			OR = {
				has_country_flag = SPR_banfighting_is_unconstitutional
				has_country_flag = SPR_bankilling_is_unconstitutional
			}
		}
		log = "[GetDateText]: [This.GetName]: spain.52.b executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.015 }
		add_relative_party_popularity = yes
		add_political_power = -50

		hidden_effect = {
			clr_country_flag = SPR_banned_bullfighting_flag
			clr_country_flag = SPR_banned_killing_the_bull_flag
			clr_country_flag = SPR_banfighting_is_unconstitutional
			clr_country_flag = SPR_bankilling_is_unconstitutional
		}
	}
}

# The Bullfighting Referendum
country_event = {
	id = spain.54
	title = spain.54.t
	desc = spain.54.d
	picture = GFX_spain_elections
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Host the Referendum
	option = {
		name = spain.54.a
		log = "[GetDateText]: [This.GetName]: spain.54.a executed"
		# Projected Success
		set_temp_variable = { temp_success_rate = 35 }
		set_temp_variable = { popularity = 30 }
		multiply_temp_variable = { popularity = government_coalition_strength }
		add_to_temp_variable = { temp_success_rate = popularity }
		set_temp_variable = { temp_failure_rate = 65 }
		subtract_from_temp_variable = { temp_failure_rate = popularity }
		custom_effect_tooltip = SPR_referendum_chance_tt

		country_event = { id = spain.55 days = 30 }
	}
}

# Referendum Day
country_event = {
	id = spain.55
	title = spain.55.t
	desc = spain.55.d
	picture = GFX_spain_elections
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Referendum Day!
	option = {
		name = spain.55.a
		log = "[GetDateText]: [This.GetName]: spain.55.a executed"
		set_temp_variable = { temp_success_rate = 35 }
		set_temp_variable = { popularity = 30 }
		multiply_temp_variable = { popularity = government_coalition_strength }
		add_to_temp_variable = { temp_success_rate = popularity }
		set_temp_variable = { temp_failure_rate = 65 }
		subtract_from_temp_variable = { temp_failure_rate = popularity }

		if = { limit = { has_country_flag = SPR_pro_ban_campaign }
			add_to_temp_variable = { temp_success_rate = 5 }
			subtract_from_temp_variable = { temp_failure_rate = 5 }
		}

		random_list = {
			temp_success_rate = {
				set_temp_variable = { culture_index = 0 }
				set_temp_variable = { cultural_opinion = 2 }
				SPR_modify_cultural_opinion = yes
				set_party_index_to_ruling_party = yes
				set_temp_variable = { party_popularity_increase = 0.02 }
				add_relative_party_popularity = yes
				add_political_power = 100

				set_country_flag = SPR_results_passed
			}
			temp_failure_rate = {

				set_temp_variable = { culture_index = 0 }
				set_temp_variable = { cultural_opinion = -3 }
				SPR_modify_cultural_opinion = yes
				set_party_index_to_ruling_party = yes
				set_temp_variable = { party_popularity_increase = -0.03 }
				add_relative_party_popularity = yes
				set_temp_variable = { party_index = 20 }
				set_temp_variable = { party_popularity_increase = 0.02 }
				set_temp_variable = { temp_outlook_increase = 0.02 }
				add_relative_party_popularity = yes
				add_political_power = -50

				set_country_flag = SPR_results_failed
				hidden_effect = {
					clr_country_flag = SPR_banned_bullfighting_flag
					clr_country_flag = SPR_banned_killing_the_bull_flag
				}
			}
		}
	}
}

# Results of the Referendum
country_event = {
	id = spain.56
	title = spain.56.t
	desc = {
		text = spain.56.d
		trigger = {
			has_country_flag = SPR_results_passed
		}
	}
	desc = {
		text = spain.56.d2
		trigger = {
			has_country_flag = SPR_results_failed
		}
	}
	picture = GFX_spain_elections
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Another Referendum Completed
	option = {
		name = spain.56.a
		log = "[GetDateText]: [This.GetName]: spain.56.a executed"
		if = { limit = { has_country_flag = SPR_results_passed }
			effect_tooltip = {
				set_temp_variable = { culture_index = 0 }
				set_temp_variable = { cultural_opinion = 2 }
				SPR_modify_cultural_opinion = yes
				set_party_index_to_ruling_party = yes
				set_temp_variable = { party_popularity_increase = 0.02 }
				add_relative_party_popularity = yes
				add_political_power = 100
			}
		}
		hidden_effect = {
			clr_country_flag = SPR_results_failed
			clr_country_flag = SPR_results_passed
		}
	}
}

# The Question of Thrones
country_event = {
	id = spain.57
	title = spain.57.t
	desc = spain.57.d
	picture = GFX_spain_throne
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# The Carlists Will Rise
	option = {
		name = spain.57.a
		log = "[GetDateText]: [This.GetName]: spain.57.a executed"
		set_country_flag = SPR_carlists_chosen
		set_variable = { Monarchist_leader = 2 } # Skips Bourbon Shit
		set_variable = { Western_Autocracy_leader = 2 }
		ai_chance = {
			factor = 0
			modifier = {
				add = 20
				is_historical_focus_on = no
			}
		}
	}

	# The House of Bourbon
	option = {
		name = spain.57.b
		log = "[GetDateText]: [This.GetName]: spain.57.b executed"
		set_country_flag = SPR_bourbon_monarchist
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				is_historical_focus_on = no
			}
		}
	}
}

# The Constitution Reformed
country_event = {
	id = spain.58
	title = spain.58.t
	desc = spain.58.d
	picture = GFX_message_signing
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# A New Monarchy
	option = {
		name = spain.58.a
		log = "[GetDateText]: [This.GetName]: spain.58.a executed"
		add_political_power = 50
		add_stability = 0.05
		set_temp_variable = { party_index = 0 }
		set_temp_variable = { party_popularity_increase = 0.05 }
		set_temp_variable = { temp_outlook_increase = 0.05 }
		add_relative_party_popularity = yes


		custom_effect_tooltip = SPR_spain_58_a_tt
		hidden_effect = {
			clear_array = ruling_party
			clear_array = gov_coalition_array
			add_to_array = { ruling_party = 0 }
			update_government_coalition_strength = yes
			update_party_name = yes
			set_coalition_drift = yes
			set_ruling_leader = yes
			set_leader = yes
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
			}
		}

		set_country_flag = SPR_constitutional_monarchy_flag
		ai_chance = {
			factor = 1
		}
	}

	# Return to Absolutism
	option = {
		name = spain.58.b
		log = "[GetDateText]: [This.GetName]: spain.58.b executed"
		add_political_power = 50
		add_war_support = 0.05
		set_temp_variable = { party_index = 23 }
		set_temp_variable = { party_popularity_increase = 0.05 }
		set_temp_variable = { temp_outlook_increase = 0.05 }
		add_relative_party_popularity = yes

		custom_effect_tooltip = SPR_spain_58_b_tt
		hidden_effect = {
			clear_array = ruling_party
			clear_array = gov_coalition_array
			add_to_array = { ruling_party = 23 }
			update_government_coalition_strength = yes
			update_party_name = yes
			set_coalition_drift = yes
			set_ruling_leader = yes
			set_leader = yes
			set_politics = {
				ruling_party = nationalist
				elections_allowed = no
			}
		}


		set_country_flag = SPR_absolutist_monarchy_flag
		ai_chance = {
			factor = 1
		}
	}
}

# Democratic Constitutionalism
country_event = {
	id = spain.59
	title = spain.59.t
	desc = spain.59.d
	picture = GFX_politics_speak
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# A New Democratic
	option = {
		name = spain.59.a
		log = "[GetDateText]: [This.GetName]: spain.59.a executed"
		add_timed_idea = {
			idea = SPR_idea_democratic_constitutionalism
			days = 365
		}
	}
}

# The Declaration of the Iberian Union
country_event = {
	id = spain.60
	title = spain.60.t
	desc = spain.60.d
	picture = GFX_iberia_united
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Declare the Union
	option = {
		name = spain.60.a
		log = "[GetDateText]: [This.GetName]: spain.60.a executed"
		set_cosmetic_tag = IBR_AUTH_S
		add_war_support = 0.05
		news_event = { id = spain.61 }
	}
}

# Spain Declares the Iberian Union
news_event = {
	id = spain.61
	title = spain.61.t
	desc = spain.61.d
	picture = GFX_iberia_united_news
	is_triggered_only = yes
	major = yes
	trigger = {
		original_tag = SPR
	}

	option = {
		name = spain.61.a
		log = "[GetDateText]: [This.GetName]: spain.61.a executed"
	}
}

# Demand The Portuguese Throne
country_event = {
	id = spain.62
	title = spain.62.t
	desc = spain.62.d
	picture = GFX_portugese_throne
	is_triggered_only = yes

	# Spain Demands The Throne
	option = {
		name = spain.62.a
		log = "[GetDateText]: [This.GetName]: spain.62.a executed"
		effect_tooltip = {
			if = { limit = { POR = { is_subject = no } }
				SPR = {
					annex_country = {
						target = POR
						transfer_troops = yes
					}
					POR = {
						every_unit_leader = {
							set_nationality = SPR
						}
					}
				}
			}
			else = {
				POR = {
					OVERLORD = {
						end_puppet = PREV
					}
					SPR = {
						puppet = PREV
					}
				}
			}
		}
		SPR = { country_event = { id = spain.63 } }

		ai_chance = {
			factor = 4
			modifier = {
				factor = 2
				is_in_faction = no
			}
			modifier = {
				factor = 2
				check_variable = { party_pop_array^23 > 0.05 }
			}
			modifier = {
				factor = 2
				check_variable = { party_pop_array^23 > 0.25 }
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = SPR
					ratio < 1
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = SPR
					ratio < 0.75
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
					tag = SPR
					ratio < 0.50
				}
			}
			modifier = {
				factor = 2
				is_top5_influencer = yes
			}
			modifier = {
				factor = 2
				is_top3_influencer = yes
			}
		}
	}

	# Fuck off Inbred Bourbons
	option = {
		name = spain.62.b
		log = "[GetDateText]: [This.GetName]: spain.62.b executed"
		trigger = {
			SPR = { has_country_flag = SPR_bourbon_monarchist }
		}

		effect_tooltip = {
			add_opinion_modifier = { target = SPR modifier = SPR_tried_to_annex_us }
			set_temp_variable = { percent_change = -10 }
			set_temp_variable = { tag_index = FROM.ID }
			set_temp_variable = { influence_target = THIS.id }
			change_influence_percentage = yes
		}

		SPR = { country_event = { id = spain.64 } }
		ai_chance = {
			factor = 5
			modifier = {
				factor = 2
				is_in_faction = yes
			}
			modifier = {
				factor = 1.25
				is_guaranteed_by = ENG
			}
			modifier = {
				factor = 2
				POR = { is_subject = yes }
			}
			modifier = {
				factor = 2.0
				has_government = nationalist
			}
		}
	}

	# Fuck off Carlists
	option = {
		name = spain.62.c
		trigger = {
			SPR = { has_country_flag = SPR_carlist_rising }
		}

		effect_tooltip = {
			add_opinion_modifier = { target = SPR modifier = SPR_tried_to_annex_us }
			set_temp_variable = { percent_change = -10 }
			set_temp_variable = { tag_index = FROM.ID }
			set_temp_variable = { influence_target = THIS.id }
			change_influence_percentage = yes
		}

		SPR = { country_event = { id = spain.64 } }
		ai_chance = {
			factor = 5
			modifier = {
				factor = 2
				is_in_faction = yes
			}
			modifier = {
				factor = 1.25
				is_guaranteed_by = ENG
			}
			modifier = {
				factor = 2.0
				has_government = nationalist
			}
			modifier = {
				factor = 2
				POR = { is_subject = yes }
			}
		}
	}
}

# Portgual Concedes to The [INSERT DYNASTY HERE]
country_event = {
	id = spain.63
	title = spain.63.t
	desc = spain.63.d
	picture = GFX_politics_talks
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Direct Rule for Now
	option = {
		name = spain.63.a
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		annex_country = {
			target = POR
			transfer_troops = yes
		}
		POR = {
			every_unit_leader = {
				set_nationality = SPR
			}
		}
		if = { limit = { has_idea = SPR_a_great_victory_for_spain_idea }
			modify_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}

		ai_chance = { # AI Forced to Optimal Path
			factor = 0
		}
	}

	# Allow the Portuguese to Rule
	option = {
		name = spain.63.b
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		if = { limit = { POR = { is_subject = yes } }
			POR = {
				OVERLORD = {
					end_puppet = PREV
				}
			}
		}
		puppet = POR
		set_temp_variable = { percent_change = 15 }
		set_temp_variable = { tag_index = THIS.id }
		set_temp_variable = { influence_target = POR.id }
		change_influence_percentage = yes
		if = { limit = { has_idea = SPR_a_great_victory_for_spain_idea }
			modify_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Portugal Denies the Concessions
country_event = {
	id = spain.64
	title = spain.64.t
	desc = spain.64.d
	picture = GFX_politics_talks
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Invade the Inferior Spanish
	option = {
		name = spain.64.a
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes
		add_war_support = -0.05
		set_temp_variable = { percent_change = -10 }
		set_temp_variable = { tag_index = THIS.id }
		set_temp_variable = { influence_target = FROM.id }
		change_influence_percentage = yes
		for_each_scope_loop = {
			array = POR.owned_states
			add_claim_by = SPR
		}
		create_wargoal = {
			target = FROM
			type = annex_everything
		}
		reverse_add_opinion_modifier = {
			target = FROM
			modifier = SPR_tried_to_annex_us
		}

		ai_chance = {
			factor = 1
		}
	}
}

# Demand Andorra
country_event = {
	id = spain.65
	title = spain.65.t
	desc = spain.65.d
	picture = GFX_politics_demands
	is_triggered_only = yes
	trigger = {
		OR = {
			original_tag = ADO
			original_tag = FRA
			owns_state = 945
		}
	}

	# Haha Lila Hemd
	option = {
		name = spain.65.a
		effect_tooltip = {
			if = { limit = { NOT = { has_global_flag = GAME_RULE_microstates_removed } }
				SPR = {
					annex_country = {
						target = ADO
						transfer_troops = yes
					}
					ADO = {
						every_unit_leader = {
							set_nationality = SPR
						}
					}
				}
			}
			else = {
				SPR = {
					transfer_state = 945
				}
			}
		}

		SPR = { country_event = { id = spain.66 } }
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				SPR = { is_ai = yes }
			}
		}
	}

	# Deny the Spanish
	option = {
		name = spain.65.b
		effect_tooltip = {
			SPR = {
				add_state_claim = 945
				create_wargoal = {
					target = PREV
					type = take_claimed_state
					generator = { 945 }
				}
			}
		}

		SPR = { country_event = { id = spain.67 } }
		ai_chance = {
			factor = 2
		}
	}
}

# Andorra Concedes
country_event = {
	id = spain.66
	title = spain.66.t
	desc = spain.66.d
	picture = GFX_politics_talks
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Haha Lila Hemd
	option = {
		name = spain.66.a
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
		if = { limit = { NOT = { has_global_flag = GAME_RULE_microstates_removed } }
			for_each_scope_loop = {
				array = ADO.core_states
				add_core_of = SPR
			}
			annex_country = {
				target = ADO
				transfer_troops = yes
			}
			ADO = {
				every_unit_leader = {
					set_nationality = SPR
				}
			}
		}
		else = {
			SPR = {
				transfer_state = 945
			}
		}
		if = { limit = { has_idea = SPR_a_great_victory_for_spain_idea }
			modify_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
	}
}

# Deny the Spanish
country_event = {
	id = spain.67
	title = spain.67.t
	desc = spain.67.d
	picture = GFX_politics_talks
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Haha Lila Hemd
	option = {
		name = spain.67.a
		log = "[GetDateText]: [This.GetName]: spain.67.a executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		add_relative_party_popularity = yes
		add_war_support = -0.05
		set_temp_variable = { percent_change = -10 }
		set_temp_variable = { tag_index = THIS.id }
		set_temp_variable = { influence_target = FROM.id }
		change_influence_percentage = yes
		add_state_claim = 945
		create_wargoal = {
			target = FROM
			type = take_claimed_state
			generator = { 945 }
		}
		reverse_add_opinion_modifier = {
			target = FROM
			modifier = SPR_tried_to_annex_us
		}
	}
}

# Demand the Rock
country_event = {
	id = spain.68
	title = spain.68.t
	desc = spain.68.d
	picture = GFX_Gibraltar
	is_triggered_only = yes

	# Give up the Rock
	option = {
		name = spain.68.a
		log = "[GetDateText]: [This.GetName]: spain.68.a executed"
		effect_tooltip = {
			SPR = {
				add_state_core = 19
				transfer_state = 19
			}
		}
		FROM = { country_event = { id = spain.69 } }
		ai_chance = {
			factor = 5
			modifier = {
				factor = 1.50
				strength_ratio = {
					tag = SPR
					ratio < 1
				}
			}
			modifier = {
				factor = 1.50
				strength_ratio = {
					tag = SPR
					ratio < 0.50
				}
			}
			modifier = {
				factor = 1.50
				strength_ratio = {
					tag = SPR
					ratio < 0.25
				}
			}
			modifier = {
				factor = 1.25
				is_influencer = yes
			}
			modifier = {
				factor = 1.5
				is_top3_influencer = yes
			}
			modifier = {
				factor = 3
				is_top_eighty_influencer = yes
			}
		}
	}

	# Fuck off Spain!
	option = {
		name = spain.68.b
		log = "[GetDateText]: [This.GetName]: spain.68.b executed"
		effect_tooltip = {
			SPR = {
				add_state_core = 19
				create_wargoal = {
					target = THIS
					type = take_core_state
					generator = { 19 }
				}
			}
		}
		FROM = { country_event = { id = spain.70 } }
		ai_chance = {
			factor = 10
			modifier = {
				factor = 5
				19 = { is_owned_by = ENG }
			}
			modifier = {
				factor = 2
				is_in_faction = yes
			}
			modifier = {
				factor = 1.5
				strength_ratio = {
					tag = SPR
					ratio > 0.99
				}
			}
			modifier = {
				factor = 1.75
				strength_ratio = {
					tag = SPR
					ratio > 1.5
				}
			}
			modifier = {
				factor = 2
				NOT = { is_influencer = yes }
			}
		}
	}
}

# [OWNER] Gives up Gibraltar
country_event = {
	id = spain.69
	title = spain.69.t
	desc = spain.69.d
	picture = GFX_Gibraltar
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Another Victory for Spain!
	option = {
		name = spain.69.a
		log = "[GetDateText]: [This.GetName]: spain.69.a executed"
		add_state_core = 19
		transfer_state = 19

		set_temp_variable = { party_index = 23 }
		set_temp_variable = { party_popularity_increase = 0.05 }
		set_temp_variable = { temp_outlook_increase = 0.05 }
		add_relative_party_popularity = yes
		if = { limit = { has_idea = SPR_a_great_victory_for_spain_idea }
			modify_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
		else = {
			add_timed_idea = {
				idea = SPR_a_great_victory_for_spain_idea
				days = 180
			}
		}
	}
}

# [OWNER] Refuses to Cede Gibraltar
country_event = {
	id = spain.70
	title = spain.70.t
	desc = spain.70.d
	picture = GFX_Gibraltar
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Fuck them!
	option = {
		name = spain.70.a
		log = "[GetDateText]: [This.GetName]: spain.70.a executed"
		add_war_support = 0.05
		add_state_core = 19
		create_wargoal = {
			target = FROM
			type = take_core_state
			generator = { 19 }
		}

		ai_chance = {
			factor = 1
		}
	}
}

# The Spanish Empire Revived
news_event = {
	id = spain.71
	title = spain.71.t
	desc = spain.71.d
	picture = GFX_iberia_united_news
	is_triggered_only = yes
	major = yes

	# A Worrying Development
	option = {
		name = spain.71.a
		log = "[GetDateText]: [This.GetName]: spain.71.a executed"
	}
}

# The LGBTQA Stance
country_event = {
	id = spain.72
	title = spain.72.t
	desc = spain.72.d
	picture = GFX_politics_speak
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# A New Stance
	option = {
		name = spain.72.a
		log = "[GetDateText]: [This.GetName]: spain.72.a executed"

		if = { limit = { has_idea = SPR_anti_lgbtqa_stance_idea }
			swap_ideas = {
				add_idea = SPR_pro_lgbtqa_stance_idea
				remove_idea = SPR_anti_lgbtqa_stance_idea
			}
		}
		else = {
			add_ideas = SPR_pro_lgbtqa_stance_idea
		}

		if = { limit = { has_country_flag = SPR_ban_gays_stance_conserv_flag }
			clr_country_flag = SPR_ban_gays_stance_conserv_flag
		}
		if = { limit = { has_country_flag = SPR_status_quo_stance_conserv_flag }
			clr_country_flag = SPR_status_quo_stance_conserv_flag
		}
		set_country_flag = SPR_pro_gay_stance_conserv_flag

		ai_chance = {
			factor = 0
		}
	}


	# Maintain the Status Quo
	option = {
		name = spain.72.b
		log = "[GetDateText]: [This.GetName]: spain.72.b executed"

		add_political_power = 150

		if = { limit = { has_country_flag = SPR_ban_gays_stance_conserv_flag }
			clr_country_flag = SPR_ban_gays_stance_conserv_flag
		}
		if = { limit = { has_country_flag = SPR_pro_gay_stance_conserv_flag }
			clr_country_flag = SPR_pro_gay_stance_conserv_flag
		}
		set_country_flag = SPR_status_quo_stance_conserv_flag
		ai_chance = {
			factor = 1
		}
	}

	# Ban Gays
	option = {
		name = spain.72.c
		log = "[GetDateText]: [This.GetName]: spain.72.c executed"
		if = { limit = { has_idea = SPR_anti_lgbtqa_stance_idea }
			swap_ideas = {
				add_idea = SPR_anti_lgbtqa_stance_idea
				remove_idea = SPR_pro_lgbtqa_stance_idea
			}
		}
		else = {
			add_ideas = SPR_anti_lgbtqa_stance_idea
		}

		if = { limit = { has_country_flag = SPR_pro_gay_stance_conserv_flag }
			clr_country_flag = SPR_pro_gay_stance_conserv_flag
		}
		if = { limit = { has_country_flag = SPR_status_quo_stance_conserv_flag }
			clr_country_flag = SPR_status_quo_stance_conserv_flag
		}
		set_country_flag = SPR_ban_gays_stance_conserv_flag
		ai_chance = {
			factor = 0
		}
	}
}

# Pin Parental Education
country_event = {
	id = spain.73
	title = spain.73.t
	desc = spain.73.d
	picture = GFX_politics_speak
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Full Parental Veto
	option = {
		name = spain.73.a
		add_ideas = SPR_parental_choice_on_all_topics_idea
		add_stability = -0.05
		add_political_power = -100

		set_country_flag = SPR_pin_parental_education_full_flag
		ai_chance = {
			factor = 0
		}
	}

	# Veto on Sexual Education and Other Controversial Topics
	option = {
		name = spain.73.b
		add_ideas = SPR_parental_choice_on_controversial_idea
		add_stability = -0.05
		add_political_power = -50

		set_country_flag = SPR_pin_parental_education_controversial_flag
		ai_chance = {
			factor = 1
		}
	}

	# Actually... we shouldn't do this
	option = {
		name = spain.73.c

		add_stability = 0.05
		add_political_power = 100
		ai_chance = {
			factor = 0
		}
	}
}

# Rise of Nativism
country_event = {
	id = spain.74
	title = spain.74.t
	desc = spain.74.d
	picture = GFX_politics_speak
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# A Harsh Stance
	option = {
		name = spain.74.a
		add_ideas = SPR_a_harsh_nativism_stance_idea

		set_country_flag = SPR_harsh_nativism_stance_flag
		ai_chance = {
			factor = 1
		}
	}

	# A Softer Stance
	option = {
		name = spain.74.b
		add_ideas = SPR_a_soft_nativism_stance_idea

		set_country_flag = SPR_soft_nativism_stance_flag
		ai_chance = {
			factor = 0
		}
	}

}

# Return of Falangism
country_event = {
	id = spain.75
	title = spain.75.t
	desc = spain.75.d
	picture = GFX_politics_speak
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
	}

	# Glory to Spain!
	option = {
		name = spain.75.a
		log = "[GetDateText]: [This.GetName]: spain.75.a executed"
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.05 }
		set_temp_variable = { temp_outlook_increase = 0.05 }
		add_relative_party_popularity = yes
		add_political_power = 100

		news_event = spain.76
		ai_chance = { factor = 1 }
	}
}

# Global Return of Francoism
news_event = {
	id = spain.76
	title = spain.76.t
	desc = spain.76.d
	picture = GFX_news_election_rally
	is_triggered_only = yes
	major = yes

	option = {
		name = spain.76.a
		log = "[GetDateText]: [This.GetName]: spain.76.a executed"
	}
}

# The New Falangist Woman
country_event = {
	id = spain.77
	title = spain.77.t
	desc = spain.77.d
	is_triggered_only = yes
	picture = GFX_politics_speak
	trigger = {
		original_tag = SPR
	}

	# Women Serve the Homefront
	option = {
		name = spain.77.a
		log = "[GetDateText]: [This.GetName]: spain.77.a executed"
		add_ideas = SPR_women_belong_on_the_homefront_idea

		set_country_flag = SPR_women_homefront_idea_flag
		ai_chance = {
			factor = 0
		}
	}

	# Strength is in Choice
	option = {
		name = spain.77.b
		log = "[GetDateText]: [This.GetName]: spain.77.b executed"
		add_ideas = SPR_women_choose_idea

		set_country_flag = SPR_women_choose_idea_flag
		ai_chance = {
			factor = 1
		}
	}
}

# Abolish the Monarchy
country_event = {
	id = spain.78
	title = spain.78.t
	desc = spain.78.d
	is_triggered_only = yes
	picture = GFX_politics_demands
	trigger = {
		original_tag = SPR
	}

	# The French Execution
	option = {
		name = spain.78.a
		log = "[GetDateText]: [This.GetName]: spain.78.a executed"
		set_country_flag = party23_banned
		set_country_flag = party0_banned
		custom_effect_tooltip = SPR_execution_of_the_monarchy_tt
		custom_effect_tooltip = SPR_monarchs_banned_tt
		if = { limit = { check_variable = { party_pop_array^23 > 0 } }
			set_temp_variable_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = party_pop_array^23 }
			add_relative_party_popularity = yes
		}
		if = { limit = { check_variable = { party_pop_array^0 > 0 } }
			set_temp_variable = { party_index = 0 }
			set_temp_variable = { party_popularity_increase = party_pop_array^0 }
			multiply_temp_variable = { party_popularity_increase = -1 }
			add_relative_party_popularity = yes
		}

		set_global_flag = SPR_french_execution_gangnam_flag
		ai_chance = {
			factor = 0
		}
	}

	# Depose the Monarchs
	option = {
		name = spain.78.b
		log = "[GetDateText]: [This.GetName]: spain.78.b executed"
		set_country_flag = party23_banned
		set_country_flag = party0_banned
		custom_effect_tooltip = SPR_monarchs_banned_tt
		if = { limit = { check_variable = { party_pop_array^23 > 0 } }
			set_temp_variable_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = party_pop_array^23 }
			add_relative_party_popularity = yes
		}
		if = { limit = { check_variable = { party_pop_array^0 > 0 } }
			set_temp_variable = { party_index = 0 }
			set_temp_variable = { party_popularity_increase = party_pop_array^0 }
			multiply_temp_variable = { party_popularity_increase = -1 }
			add_relative_party_popularity = yes
		}

		set_global_flag = SPR_chavy_deposition_of_monarchs_flag
		ai_chance = {
			factor = 1
		}
	}
}

# Spain has Abolished the Monarchy
news_event = {
	id = spain.79
	title = {
		text = spain.79.t1
		trigger = {
			has_global_flag = SPR_french_execution_gangnam_flag
		}
	}
	title = {
		text = spain.79.t2
		trigger = {
			has_global_flag = SPR_chavy_deposition_of_monarchs_flag
		}
	}
	desc = {
		text = spain.79.d1
		trigger = {
			has_global_flag = SPR_french_execution_gangnam_flag
		}
	}
	desc = {
		text = spain.79.d2
		trigger = {
			has_global_flag = SPR_chavy_deposition_of_monarchs_flag
		}
	}
	picture = GFX_news_election_rally
	is_triggered_only = yes
	major = yes
	trigger = {
		original_tag = SPR
	}

	# A New Way for Spain
	option = {
		name = spain.79.a
		log = "[GetDateText]: [This.GetName]: spain.79.a executed"
	}
}

# The Emancipation of the New Woman
country_event = {
	id = spain.80
	title = spain.80.t
	desc = spain.80.d
	is_triggered_only = yes
	picture = GFX_politics_demands
	trigger = {
		original_tag = SPR
	}

	# Yes
	option = {
		name = spain.80.a
		log = "[GetDateText]: [This.GetName]: spain.80.a executed"
		add_ideas = SPR_the_emancipation_of_the_woman_idea
	}
}

# Revised immigration Rule
country_event = {
	id = spain.81
	title = spain.81.t
	desc = spain.81.d
	is_triggered_only = yes
	picture = GFX_politics_demands
	trigger = {
		original_tag = SPR
	}

	# Citizenship for All
	option = {
		name = spain.81.a
		log = "[GetDateText]: [This.GetName]: spain.81.a executed"

		if = {
			limit = { has_idea = SPR_idea_open_borders_1 }

			swap_ideas = {
				remove_idea = SPR_idea_open_borders_1
				add_idea = SPR_idea_open_borders_2
			}
		}
		else = {
			add_ideas = SPR_idea_open_borders_1
		}

	}

	# Visa Status
	option = {
		name = spain.81.b
		log = "[GetDateText]: [This.GetName]: spain.81.b executed"

		add_ideas = SPR_idea_visa_programs
	}

	# No Visa, No Entrance
	option = {
		name = spain.81.c
		log = "[GetDateText]: [This.GetName]: spain.82.c executed"
		if = {
			limit = { has_idea = SPR_anti_immigration_policies_idea }

			swap_ideas = {
				remove_idea = SPR_anti_immigration_policies_idea
				add_idea = SPR_anti_immigration_policies_idea_2
			}
		}
		else = {
			add_ideas = SPR_anti_immigration_policies_idea
		}

	}
}

# The Blueshirts March on Vitoria
country_event = {
	id = spain.83
	title = spain.83.t
	desc = spain.83.d
	is_triggered_only = yes
	picture = GFX_politics_autocracy
	trigger = {
		original_tag = SPR
	}

	# The Night of Broken Vitoria
	option = {
		name = spain.83.a
		log = "[GetDateText]: [This.GetName]: spain.83.a executed"
		add_stability = -0.05
		add_political_power = -150
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -15 }
		SPR_modify_cultural_opinion = yes

		custom_effect_tooltip = SPR_the_following_may_happen_tt
		random_list = {
			30 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = 0.05 }
				add_relative_party_popularity = yes
				add_war_support = 0.05
				add_political_power = 150
				88 = { remove_core_of = NAV }
				set_country_flag = SPR_option_1
			}
			70 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = -0.05 }
				add_relative_party_popularity = yes
				add_stability = -0.02
				88 = { add_manpower = -2000 }
			}
		}

		set_country_flag = SPR_night_of_broken_vitora_flag
		country_event = { id = spain.84 }
	}

	# Round the Conspirators
	option = {
		name = spain.83.b
		log = "[GetDateText]: [This.GetName]: spain.83.b executed"
		add_stability = -0.02
		add_political_power = -75
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		custom_effect_tooltip = SPR_the_following_may_happen_tt
		random_list = {
			40 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = 0.05 }
				add_relative_party_popularity = yes
				add_war_support = 0.025
				add_political_power = 75
				set_country_flag = SPR_option_1
			}
			60 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = -0.05 }
				add_relative_party_popularity = yes
				add_stability = -0.02
				88 = { add_manpower = -2000 }
			}
		}

		set_country_flag = SPR_round_up_the_conspirators_flag
		country_event = { id = spain.84 }
	}
}

# The Results of the Attack
country_event = {
	id = spain.84
	title = spain.84.t
	desc = {
		text = spain.84.d1
		trigger = {
			has_country_flag = SPR_night_of_broken_vitora_flag
			NOT = { has_country_flag = SPR_option_1 }
		}
	}
	desc = {
		text = spain.84.d2
		trigger = {
			has_country_flag = SPR_night_of_broken_vitora_flag
	 		has_country_flag = SPR_option_1
		}
	}
	desc = {
		text = spain.84.d3
		trigger = {
			has_country_flag = SPR_round_up_the_conspirators_flag
			NOT = { has_country_flag = SPR_option_1 }
		}
	}
	desc = {
		text = spain.84.d4
		trigger = {
			has_country_flag = SPR_round_up_the_conspirators_flag
			has_country_flag = SPR_option_1
		}
	}
	is_triggered_only = yes
	picture = GFX_politics_autocracy
	trigger = {
		original_tag = SPR
	}

	# The Night of Broken Vitoria
	option = {
		name = spain.84.a
		log = "[GetDateText]: [This.GetName]: spain.84.a executed"
		if = { limit = { has_country_flag = SPR_night_of_broken_vitora_flag }
			if = { limit = { has_country_flag = SPR_option_1 }
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = 0.05 }
					add_relative_party_popularity = yes
					add_war_support = 0.05
					add_political_power = 150
					88 = { remove_core_of = NAV }
				}
			}
			else = {
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = -0.05 }
					add_relative_party_popularity = yes
					add_stability = -0.02
					88 = { add_manpower = -2000 }
				}
			}
			clr_country_flag = SPR_option_1
		}
		else = {
			if = { limit = { has_country_flag = SPR_option_1 }
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = 0.05 }
					add_relative_party_popularity = yes
					add_war_support = 0.025
					add_political_power = 75
				}
			}
			else = {
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = -0.05 }
					add_relative_party_popularity = yes
					add_stability = -0.02
					88 = { add_manpower = -2000 }
				}
			}
			clr_country_flag = SPR_option_1
		}
	}
}

#Prestige Tanker Accident
country_event = {
	id = spain.85
	title = spain.85.t
	desc = spain.85.d
	trigger = {
		tag = SPR
		date > 2002.1.1
	}
	picture = GFX_prestige_tanker
	is_triggered_only = yes

	# Haha Pink Shirt - Oil
	option = {
		name = spain.85.a
		log = "[GetDateText]: [This.GetName]: spain.85.b executed"

		set_temp_variable = { treasury_change = -2.5 }
		modify_treasury_effect = yes

		add_manpower = -3000

		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = -3 }
		SPR_modify_cultural_opinion = yes

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.07 }
		add_relative_party_popularity = yes

		# Penalty in the Coastline
		944 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }
		89 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }
		1040 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }
		1055 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }
		60 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }
		958 = { add_dynamic_modifier = { modifier = SPR_oil_spill days = 1460 } }

		set_country_flag = SPR_prestige_oil_spill
		if = { limit = { has_completed_focus = SPR_el_oro_negro }
			add_stability = -0.05
		}
	}
}

# The Blueshirts March on Barcelona
country_event = {
	id = spain.86
	title = spain.86.t
	desc = spain.86.d
	is_triggered_only = yes
	picture = GFX_politics_autocracy
	trigger = {
		original_tag = SPR
	}

	# The Night of Broken Barcelona
	option = {
		name = spain.86.a
		log = "[GetDateText]: [This.GetName]: spain.86.a executed"
		add_stability = -0.05
		add_political_power = -150
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -15 }
		SPR_modify_cultural_opinion = yes

		custom_effect_tooltip = SPR_the_following_may_happen_tt
		random_list = {
			30 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = 0.05 }
				add_relative_party_popularity = yes
				add_war_support = 0.05
				add_political_power = 150
				86 = { remove_core_of = CAT }
				set_country_flag = SPR_option_1
			}
			70 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = -0.05 }
				add_relative_party_popularity = yes
				add_stability = -0.02
				86 = { add_manpower = -2000 }
			}
		}

		set_country_flag = SPR_blueshirts_barcelona_flag
		country_event = { id = spain.87 }

	}

	# Round the Conspirators
	option = {
		name = spain.86.b
		log = "[GetDateText]: [This.GetName]: spain.86.b executed"

		add_stability = -0.02
		add_political_power = -75
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes

		custom_effect_tooltip = SPR_the_following_may_happen_tt
		random_list = {
			40 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = 0.05 }
				add_relative_party_popularity = yes
				add_war_support = 0.025
				add_political_power = 75
				set_country_flag = SPR_bar_option_1
			}
			60 = {
				set_temp_variable = { party_index = 21 }
				set_temp_variable = { party_popularity_increase = -0.05 }
				add_relative_party_popularity = yes
				add_stability = -0.02
				86 = { add_manpower = -2000 }
			}
		}

		set_country_flag = SPR_round_up_the_conspirators_barcelona_flag
		country_event = { id = spain.87 }
	}
}

# The Blueshirts March on Barcelona
country_event = {
	id = spain.87
	title = spain.87.t
	desc = {
		text = spain.87.d1
		trigger = {
			has_country_flag = SPR_blueshirts_barcelona_flag
			NOT = { has_country_flag = SPR_bar_option_1 }
		}
	}
	desc = {
		text = spain.87.d2
		trigger = {
			has_country_flag = SPR_blueshirts_barcelona_flag
	 		has_country_flag = SPR_bar_option_1
		}
	}
	desc = {
		text = spain.87.d3
		trigger = {
			has_country_flag = SPR_round_up_the_conspirators_barcelona_flag
			NOT = { has_country_flag = SPR_bar_option_1 }
		}
	}
	desc = {
		text = spain.87.d4
		trigger = {
			has_country_flag = SPR_round_up_the_conspirators_barcelona_flag
			has_country_flag = SPR_bar_option_1
		}
	}
	is_triggered_only = yes
	picture = GFX_politics_autocracy
	trigger = {
		original_tag = SPR
	}

	# The Night of Broken Barcelona
	option = {
		name = spain.87.a
		log = "[GetDateText]: [This.GetName]: spain.87.a executed"
		if = { limit = { has_country_flag = SPR_night_of_broken_vitora_flag }
			if = { limit = { has_country_flag = SPR_bar_option_1 }
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = 0.05 }
					add_relative_party_popularity = yes
					add_war_support = 0.05
					add_political_power = 150
					88 = { remove_core_of = CAT }
				}
			}
			else = {
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = -0.05 }
					add_relative_party_popularity = yes
					add_stability = -0.02
					88 = { add_manpower = -2000 }
				}
			}
			clr_country_flag = SPR_bar_option_1
		}
		else = {
			if = { limit = { has_country_flag = SPR_bar_option_1 }
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = 0.05 }
					add_relative_party_popularity = yes
					add_war_support = 0.025
					add_political_power = 75
				}
			}
			else = {
				effect_tooltip = {
					set_temp_variable = { party_index = 21 }
					set_temp_variable = { party_popularity_increase = -0.05 }
					add_relative_party_popularity = yes
					add_stability = -0.02
					88 = { add_manpower = -2000 }
				}
			}
			clr_country_flag = SPR_bar_option_1
		}
	}
}

# 2005 Migrant Crisis
country_event = {
	id = spain.201
	title = spain.201.t
	desc = spain.201.d
	is_triggered_only = yes
	picture = GFX_2005_migrant_crisis
	trigger = {
		original_tag = SPR
	}

	#Refuse Immigrants
	option = {
		name = spain.201.a
		log = "[GetDateText]: [This.GetName]: spain.201.a executed"
		trigger = {
			OR = {
				NOT = { has_idea = SPR_idea_open_borders_1 }
				NOT = { has_idea = SPR_idea_open_borders_2 }
			}
		}

		set_temp_variable = { modify_eurosceptic = -0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		if = { limit = { has_idea = SPR_anti_immigration_policies_idea }
			swap_ideas = {
				remove_idea = SPR_anti_immigration_policies_idea
				add_idea = SPR_anti_immigration_policies_idea_2
			}
		}
		else = {
			add_ideas = SPR_anti_immigration_policies_idea
		}

		set_country_flag = SPR_refused_immigrants
		set_country_flag = SPR_mirgrant_crisis_start
	}

	#Open Borders
	option = {
		name = spain.201.b
		log = "[GetDateText]: [This.GetName]: spain.201.b executed"
		#adds open borders idea
		#no breaches
		trigger = {
			OR = {
				NOT = { has_idea = SPR_anti_immigration_policies_idea }
				NOT = { has_idea = SPR_anti_immigration_policies_idea_2 }
			}
		}

		set_temp_variable = { modify_eurosceptic = 0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		if = { limit = { has_idea = SPR_idea_open_borders_1 }
			swap_ideas = {
				remove_idea = SPR_idea_open_borders_1
				add_idea = SPR_idea_open_borders_2
			}
		}
		else = {
			add_ideas = SPR_idea_open_borders_1
		}

		set_country_flag = SPR_mirgrant_crisis_start
	}

	#Increase Immigration
	option = {
		name = spain.201.c
		log = "[GetDateText]: [This.GetName]: spain.201.c executed"
		trigger = {
			OR = {
				NOT = { has_idea = SPR_anti_immigration_policies_idea }
				NOT = { has_idea = SPR_anti_immigration_policies_idea_2 }
			}
		}

		set_temp_variable = { modify_eurosceptic = 0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		set_country_flag = SPR_increased_immigration

		add_ideas = SPR_idea_increased_immigration

		set_country_flag = SPR_mirgrant_crisis_start
	}
}

# Migrants Assault Ceuta
country_event = {
	id = spain.202
	title = spain.202.t
	desc = spain.202.d
	is_triggered_only = yes
	picture = GFX_ceuta_border_thingy
	trigger = {
		original_tag = SPR
	}

	# Nonlethal Response
	option = {
		name = spain.202.a

		add_stability = -0.02

		every_country = {
			limit = {
				has_government = democratic
			}

			add_opinion_modifier = {
				target = SPR
				modifier = small_decrease
			}
		}

		set_country_flag = SPR_ceuta_assault
	}

	# Open Fire
	option = {
		name = spain.202.b
		#Reduced chance for further breaches
		#Opinion hit with western nations
		trigger = {
			OR = {
				NOT = { has_idea = SPR_idea_open_borders_1 }
				NOT = { has_idea = SPR_idea_open_borders_2 }
				NOT = { has_idea = SPR_idea_visa_programs }
			}
		}

		set_temp_variable = { modify_eurosceptic = -0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		every_country = {
			limit = {
				has_government = democratic
			}

			add_opinion_modifier = {
				target = SPR
				modifier = large_decrease
			}
		}

		set_country_flag = SPR_ceuta_assault
		set_country_flag = SPR_border_massacre
	}

	#Remove Fences (open borders)
	option = {
		name = spain.202.c
		#adds open borders idea
		#no futher breaches
		trigger = {
			OR = {
				NOT = { has_idea = SPR_anti_immigration_policies_idea }
				NOT = { has_idea = SPR_anti_immigration_policies_idea_2 }
			}
		}

		set_temp_variable = { modify_eurosceptic = 0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		if = {
			limit = { has_idea = SPR_idea_open_borders_1 }

			swap_ideas = {
				remove_idea = SPR_idea_open_borders_1
				add_idea = SPR_idea_open_borders_2
			}
		}
		else = {
			add_ideas = SPR_idea_open_borders_1
		}

		set_country_flag = SPR_ceuta_assault
	}
}

# Migrants Assault Mellila
country_event = {
	id = spain.203
	title = spain.203.t
	desc = spain.203.d
	is_triggered_only = yes
	picture = GFX_melila_border_thingy
	trigger = {
		original_tag = SPR
	}

	# Nonlethal Response
	option = {
		name = spain.203.a

		add_stability = -0.02

		every_country = {
			limit = {
				has_government = democratic
			}

			add_opinion_modifier = {
				target = SPR
				modifier = small_decrease
			}
		}

		set_country_flag = SPR_mellila_assault
	}

	# Open Fire
	option = {
		name = spain.203.b
		trigger = {
			OR = {
				NOT = { has_idea = SPR_idea_open_borders_1 }
				NOT = { has_idea = SPR_idea_open_borders_2 }
				NOT = { has_idea = SPR_idea_visa_programs }
			}
		}

		set_temp_variable = { modify_eurosceptic = -0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		every_country = {
			limit = {
				has_government = democratic
			}

			add_opinion_modifier = {
				target = SPR
				modifier = large_decrease
			}
		}

		set_country_flag = SPR_border_massacre
		set_country_flag = SPR_mellila_assault
	}

	#Remove Fences (open borders)
	option = {
		name = spain.203.c
		trigger = {
			OR = {
				NOT = { has_idea = SPR_anti_immigration_policies_idea }
				NOT = { has_idea = SPR_anti_immigration_policies_idea_2 }
			}
		}

		set_temp_variable = { modify_eurosceptic = 0.05 }
		set_temp_variable = { modify_eurosceptic_target = ROOT }
		eurosceptic_change = yes

		if = { limit = { has_idea = SPR_idea_open_borders_1 }

			swap_ideas = {
				remove_idea = SPR_idea_open_borders_1
				add_idea = SPR_idea_open_borders_2
			}
		}
		else = {
			add_ideas = SPR_idea_open_borders_1
		}

		set_country_flag = SPR_mellila_assault
	}
}

# Juan Carlos Abdicates
country_event = {
	id = spain.204
	title = spain.204.t
	desc = spain.204.d
	picture = GFX_juan_carlos_abdication
	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = SPR_carlists_chosen }
		original_tag = SPR
		NOT = { has_country_flag = SPR_abdication_of_juan_carlos }
	}

	# Abdication of Juan Carlos
	option = {
		name = spain.204.a
		log = "[GetDateText]: [This.GetName]: spain.204.a executed"
		set_country_flag = SPR_abdication_of_juan_carlos
		if = {
			limit = {
				OR = {
					is_in_array = { ruling_party = 0 }
					is_in_array = { ruling_party = 23 }
				}
			}
			hidden_effect = {
				set_ruling_leader = yes
				set_leader = yes
			}
		}
		else = {
			set_variable = { Monarchist_leader = 1 } # Skips Bourbon Shit
			set_variable = { Western_Autocracy_leader = 1 }
		}
	}
}

# Death of Carlos Hugo
country_event = {
	id = spain.205
	title = spain.205.t
	desc = {
		text = spain.205.d1
		trigger = {
			NOT = { has_country_flag = SPR_carlists_chosen }
		}
	}
	desc = {
		text = spain.205.d2
		trigger = {
			has_country_flag = SPR_carlists_chosen
		}
	}
	picture = GFX_death_of_Carlos_hugo
	is_triggered_only = yes

	trigger = {
		original_tag = SPR
		NOT = { has_country_flag = SPR_death_of_charles_hugo }
	}

	option = {
		name = spain.205.a
		log = "[GetDateText]: [This.GetName]: spain.204.a executed"
		set_country_flag = SPR_death_of_charles_hugo
		if = { limit = { has_country_flag = SPR_carlists_chosen }
			if = {
				limit = {
					OR = {
						is_in_array = { ruling_party = 0 }
						is_in_array = { ruling_party = 23 }
					}
				}
				hidden_effect = {
					set_ruling_leader = yes
					set_leader = yes
				}
			}
			else = {
				set_variable = { Monarchist_leader = 2 } # Skips Bourbon Shit
				set_variable = { Western_Autocracy_leader = 2 }
			}
		}
	}
}

# Cidudanos Forms
country_event = {
	id = spain.206
	title = spain.206.t
	desc = spain.206.d
	picture = GFX_albert_riviera
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		set_country_flag = SPR_cidudanos_forms
	}

	option = {
		name = spain.206.a
		log = "[GetDateText]: [This.GetName]: spain.206.a executed"
		set_temp_variable = { party_index = 2 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.04 }
		add_relative_party_popularity = yes
	}
}

# Vox Forms - RWP
country_event = {
	id = spain.207
	title = spain.207.t
	desc = spain.207.d
	picture = GFX_santiago_pascal
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		clr_country_flag = SPR_espana_2000_forms
		set_country_flag = SPR_vox_forms
	}

	option = {
		name = spain.207.a
		log = "[GetDateText]: [This.GetName]: spain.207.a executed"
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.04 }
		add_relative_party_popularity = yes
	}
}

# España 2000
country_event = {
	id = spain.208
	title = spain.208.t
	desc = spain.208.d
	picture = GFX_espana_2000
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		set_country_flag = SPR_espana_2000_forms
	}

	option = {
		name = spain.208.a
		log = "[GetDateText]: [This.GetName]: spain.208.a executed"
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.04 }
		add_relative_party_popularity = yes
	}
}

# Alternativa Espanola Forms
country_event = {
	id = spain.209
	title = spain.209.t
	desc = spain.209.d
	picture = GFX_aes
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		set_country_flag = SPR_alternativa_espana_forms
	}

	option = {
		name = spain.209.a
		log = "[GetDateText]: [This.GetName]: spain.209.a executed"
		set_temp_variable = { party_index = 14 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.04 }
		add_relative_party_popularity = yes
	}
}

# Unidos Podemos
country_event = {
	id = spain.210
	title = spain.210.t
	desc = spain.210.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		set_country_flag = SPR_unidos_podemos_forms
	}

	option = {
		name = spain.210.a
		log = "[GetDateText]: [This.GetName]: spain.210.a executed"
		set_temp_variable = { party_index = 18 }
		set_temp_variable = { party_popularity_increase = 0.04 }
		set_temp_variable = { temp_outlook_increase = 0.04 }
		add_relative_party_popularity = yes
	}
}

# Unidas Podemos Name Change
country_event = {
	id = spain.211
	title = spain.211.t
	desc = spain.211.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes
	immediate = {
		clr_country_flag = SPR_unidos_podemos_forms
		set_country_flag = SPR_unidas_podemos_forms
	}

	option = {
		name = spain.211.a
		log = "[GetDateText]: [This.GetName]: spain.211.a executed"

		add_political_power = 50
	}
}

# 2010 Bilabo Recieves the Nobel Prize
country_event = {
	id = spain.212
	title = spain.212.t
	desc = spain.212.d
	picture = GFX_bilbao
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.212.a
		log = "[GetDateText]: [This.GetName]: spain.212.a executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes
	}
}

# 2000 Lugo Roman Walls Heritage State
country_event = {
	id = spain.213
	title = spain.213.t
	desc = spain.213.d
	picture = GFX_lugo
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.213.a
		log = "[GetDateText]: [This.GetName]: spain.212.a executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 2 }
		set_temp_variable = { cultural_opinion = 2 }
		SPR_modify_cultural_opinion = yes
	}
}

# ETA Car Bombing
country_event = {
	id = spain.214
	title = spain.214.t
	desc = spain.214.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.214.a
		log = "[GetDateText]: [This.GetName]: spain.214.b executed"

		add_manpower = -99

		91 = {
			damage_building = {
				type = offices
				damage = 1.0
			}
		}
	}
}

# Banning Batasuna
country_event = {
	id = spain.215
	title = spain.215.t
	desc = spain.215.d
	picture = GFX_political_deal
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.215.a
		log = "[GetDateText]: [This.GetName]: spain.215.b executed"

		add_political_power = -25

		swap_ideas = {
			remove_idea = SPR_idea_the_eta_1
			add_idea = SPR_idea_the_eta_2
		}

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_eta_down_1
	}
}

# San Sebastian Attacks Thwarted
country_event = {
	id = spain.216
	title = spain.216.t
	desc = spain.216.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.216.a
		log = "[GetDateText]: [This.GetName]: spain.216.b executed"

		88 = {
			damage_building = {
				type = rail_way
				damage = 1
			}
		}
		90 = {
			damage_building = {
				type = rail_way
				damage = 1
			}
		}
		91 = {
			damage_building = {
				type = rail_way
				damage = 1
			}
		}
	}
}

# Madrid–Barajas Airport bombing
country_event = {
	id = spain.217
	title = spain.217.t
	desc = spain.217.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.217.a
		log = "[GetDateText]: [This.GetName]: spain.217.b executed"

		add_manpower = -54

		91 = {
			damage_building = {
				type = air_base
				damage = 1
			}
		}
	}
}

# Basque Self-determination Referendum
country_event = {
	id = spain.218
	title = spain.218.t
	desc = spain.218.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.218.a
		log = "[GetDateText]: [This.GetName]: spain.218.b executed"

		add_political_power = -25

		swap_ideas = {
			remove_idea = SPR_idea_the_eta_2
			add_idea = SPR_idea_the_eta_3
		}

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_eta_down_2
	}
}

# Jurdan Martitegi Arrested
country_event = {
	id = spain.219
	title = spain.219.t
	desc = spain.219.d
	picture = GFX_ETA_leader_arrest
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.219.a
		log = "[GetDateText]: [This.GetName]: spain.219.b executed"

		add_political_power = -25

		swap_ideas = {
			remove_idea = SPR_idea_the_eta_3
			add_idea = SPR_idea_the_eta_4
		}

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes
	}
}

# Guardia Civil Bombings
country_event = {
	id = spain.220
	title = spain.220.t
	desc = spain.220.d
	picture = GFX_guardia_civil_bombing
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.220.a
		log = "[GetDateText]: [This.GetName]: spain.220.b executed"

		add_manpower = -67

		90 = {
			damage_building = {
				type = infrastructure
				damage = 1
			}
		}

		94 = {
			damage_building = {
				type = infrastructure
				damage = 1
			}
		}
	}
}

# Permenant Ceasefire With The ETA
country_event = {
	id = spain.221
	title = spain.221.t
	desc = spain.221.d
	picture = GFX_eta_ceasefire
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.221.a
		log = "[GetDateText]: [This.GetName]: spain.221.b executed"

		add_political_power = -25

		remove_ideas = SPR_idea_the_eta_4

		set_temp_variable = { culture_index = 1 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_eta_down_3
	}
}

# Constitution Day Bombings
country_event = {
	id = spain.222
	title = spain.222.t
	desc = spain.222.d
	picture = GFX_murcia_attack
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.222.a
		log = "[GetDateText]: [This.GetName]: spain.222.b executed"

		add_manpower = -5

		90 = {
			damage_building = {
				type = infrastructure
				damage = 1.5
			}
		}
		970 = {
			damage_building = {
				type = infrastructure
				damage = 0.5
			}
		}
		92 = {
			damage_building = {
				type = infrastructure
				damage = 0.5
			}
		}
		93 = {
			damage_building = {
				type = infrastructure
				damage = 0.5
			}
		}
		1040 = {
			damage_building = {
				type = infrastructure
				damage = 0.5
			}
		}
	}
}

# Another Car Bombing in Madrid
country_event = {
	id = spain.223
	title = spain.223.t
	desc = spain.223.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.223.a
		log = "[GetDateText]: [This.GetName]: spain.223.b executed"

		add_manpower = -42

		91 = {
			damage_building = {
				type = offices
				damage = 1.0
			}
		}
	}
}

# 2006 Statute of Autonomy of Catalonia
country_event = {
	id = spain.230
	title = spain.230.t
	desc = spain.230.d
	picture = GFX_2006_catalan_refer
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.230.a
		log = "[GetDateText]: [This.GetName]: spain.230.a executed"
		add_stability = 0.01
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 1 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.230.b
		log = "[GetDateText]: [This.GetName]: spain.230.b executed"
		set_temp_variable = { party_index = 1 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -3 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

}

# 2010 - Early - Spanish Constitutional Court Nullifies the State of Autonomy
country_event = {
	id = spain.231
	title = spain.231.t
	desc = spain.231.d
	picture = GFX_const_court_spain
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.231.a
		log = "[GetDateText]: [This.GetName]: spain.231.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -15 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05

		hidden_effect = { country_event = { id = spain.232 days = 40 random = 48 } }
	}
}

# 2010 - Mid to Late - Catalan Autonomy Protest
country_event = {
	id = spain.232
	title = spain.232.t
	desc = spain.232.d
	picture = GFX_2010_catalan_prot
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.232.a
		log = "[GetDateText]: [This.GetName]: spain.232.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05
		add_political_power = 100
	}

	option = {
		name = spain.232.b
		log = "[GetDateText]: [This.GetName]: spain.232.b executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_political_power = -50
	}

	option = {
		name = spain.232.c
		log = "[GetDateText]: [This.GetName]: spain.232.c executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.08 }
		set_temp_variable = { temp_outlook_increase = -0.08 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes
	}

}

# 2012 - Catalonia Demands Independence
country_event = {
	id = spain.233
	title = spain.233.t
	desc = spain.233.d
	picture = GFX_2012_catalan_prot
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	# Let Catalonia Go Free
	option = {
		name = spain.233.a
		log = "[GetDateText]: [This.GetName]: spain.232.a executed"
		custom_effect_tooltip = SPR_catalonia_is_free_tt

		CAT = {
			transfer_state = 96
			inherit_technology = FROM
		}
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_stability = 0.05

		ai_chance = {
			factor = 0
		}
	}

	# Tighten the Grip
	option = {
		name = spain.233.b
		log = "[GetDateText]: [This.GetName]: spain.232.b executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
	}
}

# 2013 - Catalan Way
country_event = {
	id = spain.234
	title = spain.234.t
	desc = spain.234.d
	picture = GFX_2012_catalan_prot
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.234.a
		log = "[GetDateText]: [This.GetName]: spain.232.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05
		add_political_power = 100
	}

	option = {
		name = spain.234.b
		log = "[GetDateText]: [This.GetName]: spain.232.b executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_political_power = -50
	}

	option = {
		name = spain.234.c
		log = "[GetDateText]: [This.GetName]: spain.232.c executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.08 }
		set_temp_variable = { temp_outlook_increase = -0.08 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes
	}

}

# 2014 - Catalan Way
country_event = {
	id = spain.235
	title = spain.235.t
	desc = spain.235.d
	picture = GFX_2014_catalan_prot
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.235.a
		log = "[GetDateText]: [This.GetName]: spain.235.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05
		add_political_power = 100
	}

	option = {
		name = spain.235.b
		log = "[GetDateText]: [This.GetName]: spain.235.b executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_political_power = -50
	}

	option = {
		name = spain.235.c
		log = "[GetDateText]: [This.GetName]: spain.235.c executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.08 }
		set_temp_variable = { temp_outlook_increase = -0.08 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes
	}

}

# 2014 - Self-Determination Referendum
country_event = {
	id = spain.236
	title = spain.236.t
	desc = spain.236.d
	picture = GFX_2014_catalan_refer
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	# Referendum
	option = {
		name = spain.236.a
		log = "[GetDateText]: [This.GetName]: spain.236.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.03
	}
}

# 2016 - Go Ahead Catalan Republic!
country_event = {
	id = spain.237
	title = spain.237.t
	desc = spain.237.d
	picture = GFX_2016_catalan_prot
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.237.a
		log = "[GetDateText]: [This.GetName]: spain.237.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05
		add_political_power = 100
	}

	option = {
		name = spain.237.b
		log = "[GetDateText]: [This.GetName]: spain.237.b executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_political_power = -50
	}

	option = {
		name = spain.237.c
		log = "[GetDateText]: [This.GetName]: spain.237.c executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.08 }
		set_temp_variable = { temp_outlook_increase = -0.08 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes
	}

}

# 2017 - Catalonian Decalaration of Independence
country_event = {
	id = spain.238
	title = spain.238.t
	desc = spain.238.d
	picture = GFX_2017_catalan_refer
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	# Let Catalonia Go Free
	option = {
		name = spain.238.a
		log = "[GetDateText]: [This.GetName]: spain.238.a executed"
		custom_effect_tooltip = SPR_catalonia_is_free_tt

		CAT = {
			transfer_state = 96
			inherit_technology = FROM
		}
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_stability = 0.05

		ai_chance = {
			factor = 0
		}
	}

	# Tighten the Grip
	option = {
		name = spain.238.b
		log = "[GetDateText]: [This.GetName]: spain.238.b executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes

		hidden_effect = {
			country_event = { id = spain.239 days = 4 }
		}
	}
}

# Charles Puigdemont Flees Spain
country_event = {
	id = spain.239
	title = spain.239.t
	desc = spain.239.d
	picture = GFX_catalan_leader_byebye
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	# Bastard
	option = {
		name = spain.239.a
		log = "[GetDateText]: [This.GetName]: spain.239.a executed"
		add_political_power = -150
		add_stability = -0.05
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
	}
}

# Trial of Catalonian Independence Leaders
country_event = {
	id = spain.240
	title = spain.240.t
	desc = spain.240.d
	picture = GFX_catalan_leaders_trial
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.240.a
		log = "[GetDateText]: [This.GetName]: spain.240.a executed"
		add_political_power = -100
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -4 }
		SPR_modify_cultural_opinion = yes

		hidden_effect = {
			country_event = { id = spain.241 days = 7 random_days = 14 }
		}
	}
}

# 2019 - Catalan Protests
country_event = {
	id = spain.241
	title = spain.241.t
	desc = spain.241.d
	picture = GFX_2019_2020_catalan_protests
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
	}
	is_triggered_only = yes

	option = {
		name = spain.241.a
		log = "[GetDateText]: [This.GetName]: spain.241.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -10 }
		SPR_modify_cultural_opinion = yes
		add_stability = -0.05
		add_political_power = 100
	}

	option = {
		name = spain.241.b
		log = "[GetDateText]: [This.GetName]: spain.241.b executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.05 }
		set_temp_variable = { temp_outlook_increase = -0.05 }
		add_relative_party_popularity = yes
		add_political_power = -50
	}

	option = {
		name = spain.241.c
		log = "[GetDateText]: [This.GetName]: spain.241.c executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.08 }
		set_temp_variable = { temp_outlook_increase = -0.08 }
		add_relative_party_popularity = yes
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes
	}
}

# 2021 - Pardoning of Catalonian Separatists
country_event = {
	id = spain.242
	title = spain.242.t
	desc = spain.242.d
	picture = GFX_2021_catalan_pardon_monamieletmesuckyour
	trigger = {
		original_tag = SPR
		owns_state = 96
		NOT = { CAT = { is_subject_of = SPR } }
		NOT = { has_country_flag = CAT_revolted_against_spain }
		nationalist_fascists_are_not_in_power_or_coalition = yes
		nationalist_right_wing_populists_are_not_in_power_or_coalition = yes
	}
	is_triggered_only = yes

	# Pardon them
	option = {
		name = spain.242.a
		log = "[GetDateText]: [This.GetName]: spain.242.a executed"
		set_temp_variable = { culture_index = 0 }
		set_temp_variable = { cultural_opinion = 15 }
		SPR_modify_cultural_opinion = yes
	}
}

# 2002 - Spain Commits State Terrorism
country_event = {
	id = spain.243
	title = spain.243.t
	desc = spain.243.d
	picture = GFX_const_court_spain
	trigger = {
		original_tag = SPR
		owns_state = 95
	}
	is_triggered_only = yes

	# Ignore the Courts
	option = {
		name = spain.243.a
		log = "[GetDateText]: [This.GetName]: spain.243.a executed"

		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = -5 }
		SPR_modify_cultural_opinion = yes
		set_temp_variable = { party_index = 21 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		set_temp_variable = { temp_outlook_increase = 0.02 }
		add_relative_party_popularity = yes

		ai_chance = {
			factor = 0
		}
	}

	# Pay Damages to Cubillo
	option = {
		name = spain.243.b
		log = "[GetDateText]: [This.GetName]: spain.243.b executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = -0.01 }
		modify_treasury_effect = yes
		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

}

# 2012 - Death of Antonio Cubillo
country_event = {
	id = spain.244
	title = spain.244.t
	desc = spain.244.d
	picture = GFX_death_Antonio_Cubillo
	trigger = {
		original_tag = SPR
		owns_state = 95
	}
	is_triggered_only = yes

	# Host a State Sponosored Funeral
	option = {
		name = spain.244.a
		log = "[GetDateText]: [This.GetName]: spain.244.a executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = -0.01 }
		modify_treasury_effect = yes
		set_temp_variable = { culture_index = 4 }
		set_temp_variable = { cultural_opinion = 5 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 0
		}
	}

	# A Sad Day for the Canary Islands
	option = {
		name = spain.244.b
		log = "[GetDateText]: [This.GetName]: spain.244.b executed"

		ai_chance = {
			factor = 1
		}
	}

}

# 2005 - Metropol Parasol Project
country_event = {
	id = spain.245
	title = spain.245.t
	desc = spain.245.d
	picture = GFX_euro_papermoney
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.245.a
		log = "[GetDateText]: [This.GetName]: spain.245.a executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = -0.03 }
		modify_treasury_effect = yes
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 6 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_metropol_parasol_project_money
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = spain.245.b
		log = "[GetDateText]: [This.GetName]: spain.245.b executed"

		add_political_power = -150
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		set_country_flag = SPR_metropol_parasol_project_political
		ai_chance = {
			factor = 0
		}
	}

	# Do Not Condone this Project
	# Project does not
	option = {
		name = spain.245.c
		log = "[GetDateText]: [This.GetName]: spain.245.c executed"

		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = -3 }
		SPR_modify_cultural_opinion = yes
		custom_effect_tooltip = SPR_ignores_the_metropol_parasol_project_tt
		set_country_flag = SPR_metropol_parasol_project_ignored
		ai_chance = {
			factor = 0
		}
	}

}

# 2008 - Funding Request for Metropol Parasol Project
country_event = {
	id = spain.246
	title = spain.246.t
	desc = spain.246.d
	picture = GFX_metropol_parasol_construction
	trigger = {
		original_tag = SPR
		NOT = { has_country_flag = SPR_metropol_parasol_project_ignored }
	}
	is_triggered_only = yes

	# Give them the Money
	option = {
		name = spain.246.a
		log = "[GetDateText]: [This.GetName]: spain.245.a executed"

		set_temp_variable = { treasury_change = gdp_total_display }
		multiply_temp_variable = { treasury_change = -0.03 }
		modify_treasury_effect = yes
		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = 3 }
		SPR_modify_cultural_opinion = yes

		modify_country_flag = { flag = SPR_metropol_parasol_project_money value = 2 }
		ai_chance = {
			factor = 0
		}
	}

	# We Are Strapped for Cash
	option = {
		name = spain.246.b
		log = "[GetDateText]: [This.GetName]: spain.246.b executed"

		set_temp_variable = { culture_index = 3 }
		set_temp_variable = { cultural_opinion = -2 }
		SPR_modify_cultural_opinion = yes

		ai_chance = {
			factor = 1
		}
	}

}

# 2009 to 2011 - Completion of the Project
country_event = {
	id = spain.247
	title = spain.247.t
	desc = spain.247.d
	picture = GFX_metropol_parasol_completed
	trigger = {
		original_tag = SPR
		NOT = { has_country_flag = SPR_metropol_parasol_project_ignored }
	}
	is_triggered_only = yes

	option = {
		name = spain.247.a
		log = "[GetDateText]: [This.GetName]: spain.247.b executed"
		add_stability = 0.05
		add_political_power = 150
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.03 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes
		set_country_flag = SPR_metropol_parsol_project_complete
		clr_country_flag = SPR_metropol_parasol_project_money
		clr_country_flag = SPR_metropol_parasol_project_political
		ai_chance = {
			factor = 0
		}
	}
}

# 2001 - Moroccan Fishery Deals
country_event = {
	id = spain.248
	title = spain.248.t
	desc = spain.248.d
	picture = GFX_FIshing_boat
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	# Deal
	option = {
		name = spain.248.a
		log = "[GetDateText]: [This.GetName]: spain.248.a executed"
		add_political_power = -25
		add_opinion_modifier = { target = MOR modifier = SPR_agreed_to_moroccan_deal }
		reverse_add_opinion_modifier = { target = MOR modifier = SPR_failure_to_reach_a_deal }
		set_temp_variable = { percent_change = 2 }
		set_temp_variable = { tag_index = SPR.id }
		set_temp_variable = { influence_target = MOR.id }
		change_influence_percentage = yes
	}

	# No Deal!
	option = {
		name = spain.248.b
		log = "[GetDateText]: [This.GetName]: spain.248.a executed"
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes
		set_temp_variable = { percent_change = -3 }
		set_temp_variable = { tag_index = SPR.id }
		set_temp_variable = { influence_target = MOR.id }
		change_influence_percentage = yes
		add_opinion_modifier = { target = MOR modifier = SPR_failure_to_reach_a_deal }
		reverse_add_opinion_modifier = { target = MOR modifier = SPR_failure_to_reach_a_deal }
	}
}

# 2008 - Funding for the Sagrada Familia
country_event = {
	id = spain.253
	title = spain.253.t
	desc = spain.253.d
	picture = GFX_Sagrada_Familia
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	option = {
		name = spain.253.a
		log = "[GetDateText]: [This.GetName]: spain.253.a executed"
		if = { limit = { NOT = { has_completed_focus = SPR_monument_maintenance } }
			set_temp_variable = { treasury_change = gdp_total_display }
			multiply_temp_variable = { treasury_change = -0.05 }
			modify_treasury_effect = yes
			add_stability = 0.02
		}
		else = {
			set_temp_variable = { treasury_change = gdp_total_display }
			multiply_temp_variable = { treasury_change = -0.075 }
			modify_treasury_effect = yes
			add_stability = 0.04
		}

		custom_effect_tooltip = SPR_sagrada_familia_construction_finishes_sooner_tt
		set_country_flag = SPR_sagra_familia_additional_funding_flag
		ai_chance = {
			factor = 0
		}
	}

	option = {
		name = spain.253.b
		log = "[GetDateText]: [This.GetName]: spain.253.b executed"
	}

}

# 2017-2028 - Construction of the Sagrada Famila Completes
country_event = {
	id = spain.254
	title = spain.254.t
	desc = spain.254.d
	picture = GFX_Sagrada_Familia
	trigger = {
		original_tag = SPR
		NOT = { has_country_flag = SPR_sagrada_familia_complete_flag }
	}
	is_triggered_only = yes

	option = {
		name = spain.253.a
		log = "[GetDateText]: [This.GetName]: spain.253.a executed"
		add_stability = 0.05
		add_political_power = 150
		set_country_flag = SPR_sagrada_familia_complete_flag
	}
}

# 2004 Madrid Bombings
country_event = {
	id = spain.255
	title = spain.255.t
	desc = spain.255.d
	picture = GFX_2004_madrid_train_bomb
	trigger = {
		original_tag = SPR
		has_start_date < 2016.1.1
	}
	is_triggered_only = yes

	# Blame the ETA
	option = {
		name = spain.255.a
		log = "[GetDateText]: [This.GetName]: spain.255.a executed"

		# Heavy Penalty to Basque Opinion and minor to others
		# Reward for Support is MUCH larger in this event
		random_list = {
			# Manipulation!
			# Heavy Penalty to popularity and stability
			50 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = -0.08 }
					set_temp_variable = { temp_outlook_increase = -0.08 }
					add_relative_party_popularity = yes
					set_temp_variable = { culture_index = 1 }
					set_temp_variable = { cultural_opinion = -20 }
					SPR_modify_cultural_opinion = yes
					add_stability = -0.075
				}
				set_country_flag = SPR_mdbombings_eta_worst_case
			}
			# We Support This Choice
			# Populartity Gain and some stability
			30 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.03 }
					set_temp_variable = { temp_outlook_increase = 0.03 }
					add_relative_party_popularity = yes
					set_temp_variable = { culture_index = 1 }
					set_temp_variable = { cultural_opinion = -20 }
					SPR_modify_cultural_opinion = yes
					add_stability = 0.025
				}
				set_country_flag = SPR_mdbombings_eta_best_case
			}
			# No real change
			20 = {
				effect_tooltip = {
					add_political_power = -100
				}
				set_country_flag = SPR_mdbombings_eta_whatever_case
			}
		}
		country_event = { id = spain.257 random_days = 5 }
		ai_chance = {
			factor = 1
		}
	}

	# Blame the Islamists
	option = {
		name = spain.255.b
		log = "[GetDateText]: [This.GetName]: spain.255.a executed"

		# Reward for Support is MUCH larger in this event
		random_list = {
			# Manipulation
			# Medium Penalty to Popluation and Stability
			30 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = -0.08 }
					set_temp_variable = { temp_outlook_increase = -0.08 }
					add_relative_party_popularity = yes
					add_stability = -0.075
				}
				set_country_flag = SPR_mdbombings_islamists_worst_case
			}
			# We Support this
			# Small Popularity gain no stability
			50 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.03 }
					set_temp_variable = { temp_outlook_increase = 0.03 }
					add_relative_party_popularity = yes
					add_stability = 0.025
				}
				set_country_flag = SPR_mdbombings_islamists_best_case
			}
			# Eh...
			20 = {
				effect_tooltip = {
					add_political_power = -100
				}
				set_country_flag = SPR_mdbombings_islamists_whatever_case
			}
		}
		country_event = { id = spain.257 random_days = 5 }
	}

	# Pray for the Fallen
	option = {
		name = spain.255.c
		log = "[GetDateText]: [This.GetName]: spain.255.a executed"

		# Some money and political power
		random_list = {
			# Medium Popularity loss
			50 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = -0.05 }
					set_temp_variable = { temp_outlook_increase = -0.05 }
					add_relative_party_popularity = yes
					add_stability = -0.05
				}
				set_country_flag = SPR_mdbombings_weak_government_case
			}
			# Medium Popularity
			50 = {
				effect_tooltip = {
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.05 }
					set_temp_variable = { temp_outlook_increase = 0.05 }
					add_relative_party_popularity = yes
					add_stability = 0.05
				}
				set_country_flag = SPR_mdbombings_supportive_government_case
			}
		}
		country_event = { id = spain.256 random_days = 5 }
	}
}

# Pray for the Fallen Response
country_event = {
	id = spain.256
	title = spain.256.t
	desc = {
		text = spain.256.d1
		trigger = {
			has_country_flag = SPR_mdbombings_weak_government_case
		}
	}
	desc = {
		text = spain.256.d2
		trigger = {
			has_country_flag = SPR_mdbombings_supportive_government_case
		}
	}
	picture = GFX_politics_speak
	trigger = {
		original_tag = SPR
		OR = {
			has_country_flag = SPR_mdbombings_weak_government_case
			has_country_flag = SPR_mdbombings_supportive_government_case
		}
	}
	is_triggered_only = yes

	option = {
		name = spain.256.a
		log = "[GetDateText]: [This.GetName]: spain.256.a executed"
		if = { limit = { has_country_flag = SPR_mdbombings_weak_government_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.05 }
			set_temp_variable = { temp_outlook_increase = -0.05 }
			add_relative_party_popularity = yes
			add_stability = -0.05
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_supportive_government_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = 0.05 }
			set_temp_variable = { temp_outlook_increase = 0.05 }
			add_relative_party_popularity = yes
			add_stability = 0.05
		}
		else = {
			add_political_power = 100
		}
	}

}

# Blame the ETA/Blame the Terrorists Response
country_event = {
	id = spain.257
	title = {
		text = spain.257.t1
		trigger = {
			OR = {
				has_country_flag = SPR_mdbombings_eta_worst_case
				has_country_flag = SPR_mdbombings_eta_best_case
				has_country_flag = SPR_mdbombings_eta_whatever_case
			}
		}
	}
	title = {
		text = spain.257.t2
		trigger = {
			OR = {
				has_country_flag = SPR_mdbombings_islamists_worst_case
				has_country_flag = SPR_mdbombings_islamists_best_case
				has_country_flag = SPR_mdbombings_islamists_whatever_case
			}
		}
	}
	desc = {
		text = spain.257.d1
		trigger = {
			has_country_flag = SPR_mdbombings_eta_worst_case
		}
	}
	desc = {
		text = spain.257.d2
		trigger = {
			has_country_flag = SPR_mdbombings_eta_best_case
		}
	}
	desc = {
		text = spain.257.d3
		trigger = {
			has_country_flag = SPR_mdbombings_eta_whatever_case
		}
	}
	desc = {
		text = spain.257.d4
		trigger = {
			has_country_flag = SPR_mdbombings_islamists_worst_case
		}
	}
	desc = {
		text = spain.257.d5
		trigger = {
			has_country_flag = SPR_mdbombings_islamists_best_case
		}
	}
	desc = {
		text = spain.257.d6
		trigger = {
			has_country_flag = SPR_mdbombings_islamists_whatever_case
		}
	}
	picture = GFX_politics_speak
	trigger = {
		original_tag = SPR
		OR = {
			has_country_flag = SPR_mdbombings_eta_worst_case
			has_country_flag = SPR_mdbombings_eta_best_case
			has_country_flag = SPR_mdbombings_eta_whatever_case
			has_country_flag = SPR_mdbombings_islamists_worst_case
			has_country_flag = SPR_mdbombings_islamists_best_case
			has_country_flag = SPR_mdbombings_islamists_whatever_case
		}
	}
	is_triggered_only = yes

	option = {
		name = spain.257.a
		log = "[GetDateText]: [This.GetName]: spain.257.a executed"
		if = { limit = { has_country_flag = SPR_mdbombings_eta_worst_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.08 }
			set_temp_variable = { temp_outlook_increase = -0.08 }
			add_relative_party_popularity = yes
			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -20 }
			SPR_modify_cultural_opinion = yes
			add_stability = -0.075
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_eta_best_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = 0.03 }
			set_temp_variable = { temp_outlook_increase = 0.03 }
			add_relative_party_popularity = yes
			set_temp_variable = { culture_index = 1 }
			set_temp_variable = { cultural_opinion = -20 }
			SPR_modify_cultural_opinion = yes
			add_stability = 0.025
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_eta_whatever_case }
			add_political_power = -100
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_islamists_worst_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.08 }
			set_temp_variable = { temp_outlook_increase = -0.08 }
			add_relative_party_popularity = yes
			add_stability = -0.075
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_islamists_best_case }
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = 0.03 }
			set_temp_variable = { temp_outlook_increase = 0.03 }
			add_relative_party_popularity = yes
			add_stability = 0.025
		}
		else_if = { limit = { has_country_flag = SPR_mdbombings_islamists_whatever_case }
			add_political_power = -100
		}
		else = {
			add_political_power = 100
		}
	}
}

# 2008 Barcelona Terror Plot
country_event = {
	id = spain.258
	title = spain.258.t
	desc = spain.258.d
	picture = GFX_barcelona_terror
	trigger = {
		original_tag = SPR
		owns_state = 86
	}
	is_triggered_only = yes

	option = {
		name = spain.258.a
		log = "[GetDateText]: [This.GetName]: spain.258.a executed"
		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = 0.01 }
		set_temp_variable = { temp_outlook_increase = 0.01 }
		add_relative_party_popularity = yes
		add_stability = 0.01
	}

}

# 2017 - Barcelona Terror Attacks
country_event = {
	id = spain.259
	title = spain.259.t
	desc = spain.259.d
	picture = GFX_barcelona_terror
	trigger = {
		original_tag = SPR
		owns_state = 86
	}
	is_triggered_only = yes

	option = {
		name = spain.259.a
		log = "[GetDateText]: [This.GetName]: spain.259.a executed"
		add_stability = -0.03
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes

		add_manpower = -15
	}

}

# 2021 - Murcia Terror Attack
country_event = {
	id = spain.260
	title = spain.260.t
	desc = spain.260.d
	picture = GFX_murcia_attack
	trigger = {
		original_tag = SPR
		NOT = { has_government = fascism }
		neutrality_neutral_muslim_brotherhood_are_not_in_power = yes
		owns_state = 969
	}
	is_triggered_only = yes

	option = {
		name = spain.260.a
		log = "[GetDateText]: [This.GetName]: spain.260.a executed"
		add_stability = -0.02
		set_temp_variable = { party_index = 20 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		set_temp_variable = { temp_outlook_increase = 0.03 }
		add_relative_party_popularity = yes

		add_manpower = -6
	}
}

# 2002 - Gribraltar Soveringty Referendum
country_event = {
	id = spain.261
	title = spain.261.t
	desc = spain.261.d
	picture = GFX_Gibraltar
	trigger = {
		original_tag = SPR
		NOT = { owns_state = 19 }
	}
	is_triggered_only = yes

	# Contest the Referendum
	option = {
		name = spain.261.a
		log = "[GetDateText]: [This.GetName]: spain.261.a executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		set_temp_variable = { temp_outlook_increase = -0.03 }
		add_relative_party_popularity = yes
		add_political_power = -150

		# Whomever Owns Gibraltar
		if = { limit = { ENG = { owns_state = 19 } }
			ENG = { country_event = { id = spain.262 random_days = 15 } }
		}
		else = {
			random_country = {
				limit = { owns_state = 19 }
				country_event = { id = spain.262 random_days = 15 }
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}

	# Gibnraltar Remains
	option = {
		name = spain.261.b
		log = "[GetDateText]: [This.GetName]: spain.261.b executed"

		# Nothing for this option
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.25
				is_historical_focus_on = no
			}
		}
	}
}

# Spain Response
# Contests the Results of the Referendum
country_event = {
	id = spain.262
	title = spain.262.t
	desc = spain.262.d
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		owns_state = 19
	}
	is_triggered_only = yes

	# Concede the Rock to Spain
	option = {
		name = spain.261.b
		log = "[GetDateText]: [This.GetName]: spain.261.b executed"

		set_party_index_to_ruling_party = yes
		set_temp_variable = { party_popularity_increase = -0.03 }
		set_temp_variable = { temp_outlook_increase = -0.03 }
		add_relative_party_popularity = yes
		effect_tooltip = {
			SPR = {
				add_state_core = 19
				transfer_state = 19
			}
		}

		hidden_effect = {
			SPR = { set_country_flag = SPR_conedede_the_rock_referendum_flag }
		}
		ai_chance = {
			base = 10
			modifier = {
				factor = 2
				OR = {
					AND = {
						check_variable = { influence_array^0 = SPR }
						check_variable = { influence_array_val^0 > 49.99 }
					}
				}
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
	option = {
		name = spain.261.b
		log = "[GetDateText]: [This.GetName]: spain.261.b executed"

		effect_tooltip = {
			SPR = {
				add_political_power = -25
			}
		}

		FROM = { country_event = { id = spain.263 } }
		hidden_effect = {
			SPR = { set_country_flag = SPR_declined_the_rock_referendum_flag }
		}
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.75
				is_historical_focus_on = no
			}
			modifier = {
				factor = 1.25
				is_historical_focus_on = yes
			}
		}
	}

}

# Returned Response from England
country_event = {
	id = spain.263
	title = {
		text = spain.263.t1
		trigger = {
			has_country_flag = SPR_declined_the_rock_referendum_flag
		}
	}
	title = {
		text = spain.263.t2
		trigger = {
			has_country_flag = SPR_conedede_the_rock_referendum_flag
		}
	}
	desc = {
		text = spain.263.d1
		trigger = {
			has_country_flag = SPR_declined_the_rock_referendum_flag
		}
	}
	desc = {
		text = spain.263.d2
		trigger = {
			has_country_flag = SPR_conedede_the_rock_referendum_flag
		}
	}
	picture = GFX_politics_protest # TODO: Replace with an image
	trigger = {
		original_tag = SPR
	}
	is_triggered_only = yes

	# Issue a Insult
	option = {
		name = spain.263.a
		trigger = {
			has_country_flag = SPR_declined_the_rock_referendum_flag
		}

		set_temp_variable = { percent_change = -2 }
		set_temp_variable = { tag_index = SPR.id }
		set_temp_variable = { influence_target = FROM.id }
		change_influence_percentage = yes

		add_opinion_modifier = { target = FROM modifier = SPR_declined_gibraltar_insult }
		ai_chance = {
			factor = 0
		}
	}

	# The People Chose Their Path
	option = {
		name = spain.263.b
		trigger = {
			has_country_flag = SPR_declined_the_rock_referendum_flag
		}

		add_opinion_modifier = { target = FROM modifier = SPR_declined_gibraltar }
		ai_chance = {
			factor = 1
		}
	}

	# The Rock Is Ours!
	option = {
		name = spain.263.c
		trigger = {
			has_country_flag = SPR_conedede_the_rock_referendum_flag
		}
		add_state_core = 19
		transfer_state = 19
		add_stability = 0.02

		ai_chance = {
			factor = 1
		}
	}
}


# The 2000 Elections
country_event = {
	id = spain.500
	title = spain.500.t
	desc = {
		text = spain.500.d
		trigger = {
			check_variable = { largest_party = 1 }
		}
	}
	desc = {
		text = spain.500.d3
		trigger = {
			check_variable = { largest_party = 3 }
			NOT = { has_country_flag = SPR_psoe_united_coalition }
		}
	}
	desc = {
		text = spain.500.d1
		trigger = {
			check_variable = { largest_party = 3 }
			has_country_flag = SPR_psoe_united_coalition
		}
	}
	desc = {
		text = spain.500.d2
		trigger = {
			NOT = { check_variable = { largest_party = 1 } }
			NOT = { check_variable = { largest_party = 3 } }
		}
	}
	picture = GFX_election_day
	is_triggered_only = yes
	trigger = {
		original_tag = SPR
		has_country_flag = generic_election_killswitch
		has_country_flag = SPR_initial_election_flag
	}
	immediate = {
		set_variable = { largest_party = -1 }
		find_highest_in_array = {
			array = party_pop_array
			value = value
			index = index
		}
		# Value
		set_variable = { largest_party = index }
		set_variable = { largest_party_val = value }

		log = "Largest Party: [?largest_party] and Largest Party Value: [?largest_party_val]"

		# Checks if the United Left / PSOE are in coalition
		if = { limit = { has_country_flag = SPR_psoe_united_coalition }
			set_variable = { psoe_united_left = party_pop_array^3 }
			add_to_variable = { psoe_united_left = party_pop_array^5 }

			if = {
				limit = {
					check_variable = {
						var = psoe_united_left
						value = largest_party_val
						compare = greater_than_or_equals
					}
				}
				set_variable = { largest_party = 3 } # Sets Largest Party to United Left
			}
		}
	}

	# Resounding Victory for the PP
	option = {
		name = spain.500.a
		trigger = {
			check_variable = { largest_party = 1 }
		}
		log = "[GetDateText]: [This.GetName]: spain.500.a executed"

		add_political_power = 100
		add_stability = 0.05

		# Clearing Shit
		clear_variable = largest_party
		clear_variable = largest_party_val
		clr_country_flag = generic_election_killswitch
		clr_country_flag = SPR_psoe_united_coalition
		clr_country_flag = SPR_initial_election_flag
	}
	option = {
		name = spain.500.b
		log = "[GetDateText]: [This.GetName]: spain.500.b executed"
		trigger = {
			NOT = { check_variable = { largest_party = 1 } }
			NOT = { check_variable = { largest_party = 3 } }
		}

		hidden_effect = {
			clear_array = ruling_party
			clear_array = gov_coalition_array
			add_to_array = { ruling_party = largest_party }
			update_government_coalition_strength = yes
			update_party_name = yes
			set_coalition_drift = yes
			set_ruling_leader = yes
			set_leader = yes
		}
		if = { limit = { check_variable = { largest_party < 4 } }
			set_politics = {
				ruling_party = democratic
				elections_allowed = yes
			}
		}
		else_if = {
			limit = {
				check_variable = { largest_party > 3 }
				check_variable = { largest_party < 11 }
			}
			set_politics = {
				ruling_party = communism
				elections_allowed = yes
			}
		}
		else_if = {
			limit = {
				check_variable = { largest_party > 9 }
				check_variable = { largest_party < 12 }
			}
			set_politics = {
				ruling_party = fascism
				elections_allowed = yes
			}
		}
		else_if = {
			limit = {
				check_variable = { largest_party > 11 }
				check_variable = { largest_party < 20 }
			}
			set_politics = {
				ruling_party = neutrality
				elections_allowed = yes
			}
		}
		else_if = { limit = { check_variable = { largest_party > 19 } }
			set_politics = {
				ruling_party = nationalist
				elections_allowed = yes
			}
		}

		# Clearing Shit
		clear_variable = largest_party
		clear_variable = largest_party_val
		clr_country_flag = generic_election_killswitch
		clr_country_flag = SPR_psoe_united_coalition
		clr_country_flag = SPR_initial_election_flag
	}
	option = {
		name = spain.500.c
		log = "[GetDateText]: [This.GetName]: spain.500.c executed"
		trigger = {
			check_variable = { largest_party = 3 }
		}

		if = { limit = { has_country_flag = SPR_psoe_united_coalition }
			hidden_effect = {
				clear_array = ruling_party
				clear_array = gov_coalition_array
				add_to_array = { ruling_party = 3 }
				add_to_array = { gov_coalition_array = 5 }
				update_government_coalition_strength = yes
				update_party_name = yes
				set_coalition_drift = yes
				set_ruling_leader = yes
				set_leader = yes
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = yes
			}
		}
		else = {
			hidden_effect = {
				clear_array = ruling_party
				clear_array = gov_coalition_array
				add_to_array = { ruling_party = 3 }
				update_government_coalition_strength = yes
				update_party_name = yes
				set_coalition_drift = yes
				set_ruling_leader = yes
				set_leader = yes
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = yes
			}
		}

		# Clearing Shit
		clear_variable = largest_party
		clear_variable = largest_party_val
		clr_country_flag = generic_election_killswitch
		clr_country_flag = SPR_psoe_united_coalition
		clr_country_flag = SPR_initial_election_flag
	}
}

# The PSOE and the IU
country_event = {
	id = spain.501
	title = spain.501.t
	desc = spain.501.d
	trigger = {
		tag = SPR
		date < 2001.1.1
	}
	is_triggered_only = yes

	# Sign the Pre-Elect Pact
	option = {
		name = spain.501.a
		log = "[GetDateText]: [This.GetName]: spain.501.b executed"

		# PSOE Loses Support
		set_temp_variable = { party_index = 3 }
		set_temp_variable = { party_popularity_increase = -0.02 }
		add_relative_party_popularity = yes
		# United Left Loses Support
		set_temp_variable = { party_index = 5 }
		add_relative_party_popularity = yes
		# PP Gains Popularity
		set_temp_variable = { party_index = 1 }
		set_temp_variable = { party_popularity_increase = 0.02 }
		add_relative_party_popularity = yes
		# Reactionries Gain Support
		set_temp_variable = { party_index = 6 }
		add_relative_party_popularity = yes

		custom_effect_tooltip = SPR_psoe_united_coalition_forms_coalition
		set_country_flag = SPR_psoe_united_coalition
	}

	# Deny the Pre-Elect Pact
	option = {
		name = spain.501.b
		log = "[GetDateText]: [This.GetName]: spain.501.b executed"

		# PSOE Gains Support
		set_temp_variable = { party_index = 3 }
		set_temp_variable = { party_popularity_increase = 0.03 }
		add_relative_party_popularity = yes
	}
}