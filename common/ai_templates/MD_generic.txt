# Author(s): AngriestBird, Simone
# Improved by KyCb(rockon)
##############################
##Compendium of Combat Width
#Militia Battalion - 3 CW 			#Motorized Airborne Infantry - 4 CW
#Motorized Militia Battalion - 4 CW #Mechanized Airborne Infantry - 4 CW
#Light Infantry - 3 CW				#Armored Airborne Infantry - 4 CW
#Motorized Infantry - 4 CW			#Marine Light Infantry - 3 CW
#Mechanized Infantry - 4 CW			#Motorized Marine Infantry - 4 CW
#Armored Infantry - 4 CW			#Mechanized Marine Infantry - 4 CW
#Airborne Light Infantry - 3 CW		#Armored Marine Infantry - 4 CW
#Light Air Assault Infantry - 3 CW	#Armored Air Assault Infantry - 4 CW
#Special Forces - 3 CW				#Tank Battalion - 4 CW
#Artillery - 3 CW					#SP Arty - 3 CW
#SP AA - 4 CW
#Companies - Support Companies
#Tank Company - 2 CW				#Light Recon - 1 CW
#Motorized Recon - 2 CW				#Mechanized Company - 2 CW
#Armored Recon - 2 CW				#Armored Recce - 2 CW
#Light Engineer - 1 CW				#Heavy Engineer - 2 CW
#Artillery BAttery - 1 CW			#SP Arty - 2 CW
#SP AA - 2 CWf
############################
#garrison
garrison_generic = {
	role = garrison
	upgrade_prio = {
		factor = 0
		modifier = {
			add = 5
			ai_has_role_template = garrison
		}
	}

	Militia_garrison = {
		reinforce_prio = 0
		custom_icon = 7
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 2
				num_of_military_factories < 3
			}
			modifier = {
				factor = 0
				OR = {
					is_major = yes
					num_of_military_factories > 3
				}
			}
		}
		enable = {
			NOT = {
				OR = {
					num_of_military_factories > 10
					is_major = yes
					tag = SOV
					tag = USA
					tag = CHI
					tag = GER
					tag = FRA
					tag = ENG
					tag = SPR
					tag = ITA
					tag = BRA
					tag = MEX
					tag = POR
					tag = RAJ
					tag = PAK
					tag = UKR
				}
			}
		}

		target_template = {
			regiments = { #12 Combat Width
				Militia_Bat = 4 #
			}
		}

		target_min_match = 0.5
	}

	L_Inf_gar = {
		reinforce_prio = 0

		upgrade_prio = {
			factor = 1

			modifier = {
				factor = 2
				num_of_military_factories > 4
			}
			modifier = {
				factor = 0
				num_of_military_factories < 5
			}
		}
		enable = {
			NOT = {
				OR = {
					num_of_military_factories > 20
					is_major = yes
					tag = SOV
					tag = USA
					tag = CHI
					tag = GER
					tag = FRA
					tag = ENG
					tag = SPR
					tag = ITA
					tag = BRA
					tag = MEX
					tag = POR
					tag = RAJ
					tag = PAK
				}
			}
		}

		target_min_match = 0.5

		target_template = {
			regiments = {
				L_Inf_Bat = 6
			}
		}
	}
}

#light Militia Divisions
Militia_generic = {
	role = Militia
	upgrade_prio = {
		factor = 1
		modifier = {
			factor = 5
			has_civil_war = yes
		}
		modifier = {
			factor = 0
			has_civil_war = no
		}
	}

	Militia_generic = {
		reinforce_prio = 0
		upgrade_prio = {
			factor = 1
			modifier = {
				add = 1
				num_of_military_factories < 4
			}
			modifier = {
				factor = 0
				OR = {
					has_war = no
					num_of_military_factories > 3
					is_major = yes
					has_idea = NATO_member
					is_sco = yes
				}
			}
		}
		enable = {
			NOT = {
				OR = {
					has_war = no
					num_of_military_factories > 3
					is_major = yes
					has_idea = NATO_member
					is_sco = yes
				}
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = { #15 CW
				Militia_Bat = 5
			}
		}
	}
	militia_brigade = {
		reinforce_prio = 0
		upgrade_prio = {
			factor = 1
			modifier = {
				add = 1
				num_of_military_factories < 5
			}
			modifier = {
				factor = 2
				has_civil_war = yes
			}
			modifier = {
				factor = 0
				OR = {
					has_war = no
					num_of_military_factories > 9
					is_major = yes
					has_idea = NATO_member
					is_sco = yes
				}
			}
		}
		enable = {
			NOT = { has_idea = NATO_member }
			is_major = no
			is_sco = no
			OR = {
				has_war = yes
				num_of_military_factories < 10
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Militia_Bat = 9
			}
			support = {
				L_Recce_Comp = 1
				L_Engi_Comp = 1
			}
		}
	}
	Mot_Militia_generic = {
		reinforce_prio = 0
		upgrade_prio = {
			factor = 1
			modifier = {
				add = 15
				has_civil_war = yes
			}
			modifier = {
				factor = 0
				OR = {
					num_of_military_factories > 7
					has_war = no
					is_major = yes
					has_idea = NATO_member
					is_sco = yes
				}
			}
		}
		enable = {
			NOT = {
				OR = {
					num_of_military_factories > 7
					has_war = no
					is_major = yes
					has_idea = NATO_member
					is_sco = yes
				}
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Mot_Militia_Bat = 7
			}
			support = {
				Mot_Recce_Comp = 1
			}
		}
	}
}

#Light Divisions
L_Inf_generic = {
	role = L_Inf
	upgrade_prio = { #These should be used extremely sparingly
		factor = 1.8
		modifier = {
			factor = 150
			surrender_progress > 0.50
		}
	}

	L_Inf_brigade = {
		upgrade_prio = {
			factor = 1
			modifier = {
				add = 5
				surrender_progress > 0.50
			}
			modifier = {
				add = 10
				any_enemy_country = {
					strength_ratio = {
						tag = ROOT
						ratio > 0.75
					}
				}
			}
			modifier = {
				add = -10
				OR = {
					num_of_military_factories > 7
					has_equipment = { Inf_equipment < 100 }
					is_major = yes
				}
			}
		}
		enable = {
			OR = {
				num_of_military_factories < 8
				has_equipment = { Inf_equipment > 100 }
				is_major = no
			}
		}

		reinforce_prio = 0
		target_min_match = 0.5

		target_template = {
			regiments = {
				L_Inf_Bat = 6
				Arty_Bat = 3
			}
			support = {
				L_Recce_Comp = 1
				L_Engi_Comp = 1
				combat_service_support_company = 1
			}
		}
	}

	L_Inf_division = {
		upgrade_prio = {
			factor = 1
			modifier = {
				add = 5
				surrender_progress > 0.50
			}
			modifier = {
				add = 10
				any_enemy_country = {
					strength_ratio = {
						tag = ROOT
						ratio > 0.75
					}
				}
			}
			modifier = {
				add = -10
				OR = {
					has_equipment = { Inf_equipment < 100 }
					num_of_military_factories > 15
					num_of_military_factories < 7
					AND = {
						surrender_progress < 0.50
						is_major = yes
					}
				}
			}
		}
		enable = {
			OR = {
				num_of_military_factories < 16
				num_of_military_factories > 6
				AND = {
					surrender_progress < 0.50
					is_major = yes
				}
			}
		}

		reinforce_prio = 0
		target_min_match = 0.5

		target_template = {
			regiments = {
				L_Inf_Bat = 9
				Arty_Bat = 3
			}
			support = {
				Arty_Battery = 1
				L_Recce_Comp = 1
				L_Engi_Comp = 1
				combat_service_support_company = 1
			}
		}
	}
}

#Light Marines
marines_generic = {
	role = marines
	upgrade_prio = {
		factor = 0.9
	}

	light_marine_brigades = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				num_of_military_factories > 5
			}
			modifier = {
				factor = 0
				num_of_naval_factories < 1
			}
		}
		enable = {
			num_of_military_factories < 5
			num_of_naval_factories > 0
		}

		target_min_match = 0.8

		target_template = {
			regiments = {
				L_Marine_Bat = 6
				Arty_Bat = 3
			}
			support = {
				L_Recce_Comp = 1
				L_Engi_Comp = 1
				SP_AA_Battery = 1
				combat_service_support_company = 1
			}
		}
	}
	mot_marines_brigades = {
		upgrade_prio = {
			factor = 0.5
			modifier = {
				factor = 0
				num_of_military_factories > 9
			}
			modifier = {
				factor = 0
				num_of_naval_factories < 1
			}
			modifier = {
				factor = 0
				num_of_military_factories < 6
			}
		}
		enable = {
			num_of_military_factories < 7
			num_of_naval_factories > 0
		}

		target_min_match = 0.8

		target_template = {
			regiments = {
				Mot_Marine_Bat = 6
			}
			support = {
				H_Engi_Comp = 1
				Mot_Recce_Comp = 1
				Arty_Battery = 1
				combat_service_support_company = 1
			}
		}
	}
	meh_marines_division_maj = {
		upgrade_prio = {
			factor = 2
			modifier = {
				factor = 0
				OR = {
					has_idea = minor_power
					has_idea = non_power
					#has_equipment = { apc_hull < 1 }
					num_of_military_factories < 12
				}
			}
			modifier = {
				factor = 0
				num_of_naval_factories < 1
			}
		}
		enable = {
			num_of_naval_factories > 0
			num_of_military_factories > 11
		}

		target_min_match = 0.8

		target_template = {
			regiments = {
				Mech_Marine_Bat = 6
				armor_Bat = 2
				SP_Arty_Bat = 2
			}
			support = {
				Mech_Recce_Comp = 1
				H_Engi_Comp = 1
				SP_AA_Battery = 1
				combat_service_support_company = 1
			}
		}
	}
	armored_marines_division = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				num_of_military_factories < 15
			}
			modifier = {
				factor = 0
				num_of_naval_factories < 1
			}
		}
		enable = {
			num_of_military_factories > 14
		}

		target_min_match = 0.8

		target_template = {
			regiments = {
				Arm_Marine_Bat = 6
				armor_Bat = 2
				SP_Arty_Bat = 2
			}
			support = {
				Arm_Recce_Comp = 1
				H_Engi_Comp = 1
				SP_AA_Battery = 1
				combat_service_support_company = 1
			}
		}
	}
}

#Special Forces
Special_Forces_generic = {
	role = Special_Forces
	upgrade_prio = {
		factor = 1.2
	}

	Special_Forces_generic = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					num_of_military_factories < 5
					num_of_military_factories > 10
				}
			}
		}
		enable = {
			num_of_military_factories > 4
			num_of_military_factories < 11
		}

		reinforce_prio = 2
		target_min_match = 0.6

		target_template = {
			regiments = {
				Special_Forces = 6
				Arty_Bat = 3
			}
			support = {
				L_Recce_Comp = 1
				L_Engi_Comp = 1
				combat_service_support_company = 1
			}
		}
	}

	special_forces_division = {
		upgrade_prio = {
			factor = 4
			modifier = {
				factor = 0
				OR = {
					has_idea = minor_power
					has_idea = non_power
					num_of_military_factories < 10
				}
			}
		}
		enable = {
			num_of_military_factories > 10
		}

		reinforce_prio = 2

		target_min_match = 0.6

		target_template = {
			regiments = {
				Special_Forces = 8
				SP_Arty_Bat = 3
				SP_AA_Bat = 1
			}
			support = {
				Arm_Recce_Comp = 1
				combat_service_support_company = 1
				H_Engi_Comp = 1
				armor_Comp = 1
				SP_Arty_Battery = 1
			}
		}
	}
}

#Speed Helicopter Paratroopers
Air_heli_generic = {
	role = Air_helicopters
	upgrade_prio = {
		factor = 1
	}

	Arm_Air_assault_brigade = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				num_of_military_factories < 21
			}
		}
		enable = {
			num_of_military_factories > 20
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Arm_Air_assault_Bat = 6
				attack_helo_bat = 2
			}
			support = {
				helicopter_combat_service_support = 1
			}
		}
	}
}

#Mech Paratroopers
Air_mech_generic = {
	role = Air_mech
	upgrade_prio = {
		factor = 0.6
	}

	Air_Mech_generic = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					num_of_military_factories > 15
					num_of_military_factories < 10
				}
			}
		}
		enable = {
			OR = {
				num_of_military_factories < 16
				num_of_military_factories > 9
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Mech_Air_Inf_Bat = 6
				Arty_Bat = 2
			}
			support = {
				H_Engi_Comp = 1
				SP_AA_battery = 1
				helicopter_combat_service_support = 1
			}
		}
	}

	Air_Mech_division = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_idea = minor_power
					has_idea = non_power
					num_of_military_factories < 15
					num_of_military_factories > 20
				}
			}
		}
		enable = {
			OR = {
				num_of_military_factories < 21
				num_of_military_factories > 14
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Arty_Bat = 4
				Arm_Air_Inf_Bat = 6
			}
			support = {
				armor_Recce_Comp = 1
				H_Engi_Comp = 1
				SP_AA_Battery = 1
				helicopter_combat_service_support = 1
				armor_Comp = 1
			}
		}
	}
}

#this is related to AI Motorized Brigade
infantry_generic = {
	role = infantry
	upgrade_prio = {
		factor = 0.7
	}

	infantry_generic = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				num_of_military_factories > 7
			}
		}
		enable = {
			num_of_military_factories < 8
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Mot_Inf_Bat = 6
			}
			support = {
				Mot_Recce_Comp = 1
				H_Engi_Comp = 1
				combat_service_support_company = 1
				Arty_Battery = 1
			}
		}
	}

	infantry_division = {
		upgrade_prio = {
			factor = 1.5
			modifier = {
				factor = 0
				OR = {
					num_of_military_factories < 8
					num_of_military_factories > 15
				}
			}
		}
		enable = {
			OR = {
				num_of_military_factories > 7
				num_of_military_factories < 16
			}
		}

		target_min_match = 0.6

		target_template = {
			regiments = {
				Mot_Inf_Bat = 6
				Arty_Bat = 4
			}
			support = {
				Mot_Recce_Comp = 1
				H_Engi_Comp = 1
				armor_Comp = 1
				combat_service_support_company = 1
				SP_AA_Battery = 1
			}
		}
	}
}

#Mechanized Generic - Related to APC
APC_generic = {
	role = apc_mechanized
	upgrade_prio = {
		factor = 1
	}

	mechanized_generic = {
		upgrade_prio = {
			factor = 1
			modifier = { #Ignore if you don't have the APCS
				factor = 0
				num_of_military_factories > 15
			}
		}
		enable = {
			num_of_military_factories < 15
		}

		target_min_match = 0.7

		target_template = {
			regiments = {
				Mech_Inf_Bat = 4
				armor_Bat = 2
				SP_Arty_Bat = 2
			}
			support = {
				H_Engi_Comp = 1
				Mech_Recce_Comp = 1
				SP_AA_Battery = 1
				combat_service_support_company = 1
			}
		}
	}

	mechanized_divisions = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_idea = minor_power
					has_idea = non_power
					num_of_military_factories < 15
				}
			}
		}
		enable = {
			num_of_military_factories > 14
		}

		target_min_match = 0.7

		target_template = {
			regiments = {
				Mech_Inf_Bat = 6
				armor_Bat = 2
				SP_Arty_Bat = 3
			}
			support = {
				Mech_Recce_Comp = 1
				H_Engi_Comp = 1
				combat_service_support_company = 1
				SP_AA_Battery = 1
			}
		}
	}
}

#Mechanized Generic - Related to IFV
IFV_generic = {
	role = ifv_mechanized
	upgrade_prio = {
		factor = 1
	}

	ifv_infantry_generic = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				num_of_military_factories > 15
			}
		}
		enable = {
			num_of_military_factories < 16
		}

		target_min_match = 0.7

		target_template = {
			regiments = {
				Arm_Inf_Bat = 4
				armor_Bat = 2
				SP_Arty_Bat = 2
			}
			support = {
				H_Engi_Comp = 1
				Arm_Recce_Comp = 1
				SP_AA_Battery = 1
				combat_service_support_company = 1
			}
		}
	}

	ifv_infantry_divisions = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 5
				OR = {
					original_tag = CHI
					original_tag = USA
				}
			}
			modifier = {
				factor = 7
				original_tag = SOV
			}
			modifier = {
				factor = 0
				OR = {
					has_idea = minor_power
					has_idea = non_power
					num_of_military_factories < 15
				}
			}
		}
		enable = {
			num_of_military_factories > 16
		}

		target_min_match = 0.7

		target_template = {
			regiments = {
				Arm_Inf_Bat = 6
				armor_Bat = 2
				SP_Arty_Bat = 3
			}
			support = {
				Arm_Recce_Comp = 1
				H_Engi_Comp = 1
				combat_service_support_company = 1
				SP_AA_Battery = 1
			}
		}
	}
}

#Armored Generic
armor_generic = {
	# AI will try to have one template per role
	role = armor

	# MTTH block that decides the 'importance' of the role template compared to other role templates for spending experience on improving
	upgrade_prio = { factor = 1.2 }

	armor_generic = {
		# MTTH block that determines how likely the AI is to upgrade
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					tag = USA
					tag = CHI
					tag = SOV
					num_of_military_factories > 20
					num_of_military_factories < 12
				}
			}
		}
		# Determines the Production importance similar to above
		enable = {
			OR = {
				tag = USA
				tag = CHI
				tag = SOV
				num_of_military_factories < 21
				num_of_military_factories > 11
			}
		}

		target_min_match = 0.5

		# The actual template is designed here
		target_template = {
			regiments = {
				armor_Bat = 4
				Arm_Inf_Bat = 3
				SP_AA_Battery = 1
				SP_Arty_Bat = 2
			}
			support = {
				H_Engi_Comp = 1
				combat_service_support_company = 1
				armor_Recce_Comp = 1
			}
		}
	}

	armor_division = {
		upgrade_prio = {
			factor = 1
			modifier = {
				factor = 5
				OR = {
					tag = USA
					tag = CHI
					tag = SOV
				}
			}
			modifier = {
				factor = 0
				num_of_military_factories < 20
			}
		}
		enable = {
			num_of_military_factories > 20
		}

		target_min_match = 0.5

		target_template = {
			regiments = {
				armor_Bat = 6
				Arm_Inf_Bat = 6
				SP_Arty_Bat = 2
				SP_AA_Bat = 1
			}
			support = {
				Arm_Recce_Comp = 1
				H_Engi_Comp = 1
				combat_service_support_company = 1
				SP_AA_Battery = 1
			}
		}
	}
}